-- INSERT INTO npc VALUES (nextval('npc_seq'),2,-120,-400,0,4,false,'Nana Winterbutter','npc_nana_winterbutter.lua',1);

require("npcs.base.autonpcfunctions")

function useNPC(user,counter,param)
    thisNPC:increaseSkill(1,"common language",100);
    thisNPC:talkLanguage(CCharacter.say, CPlayer.german, "Finger weg!");
    thisNPC:talkLanguage(CCharacter.say, CPlayer.english, "Don't you touch me!");
end

function initializeNpc()
    if TraderFirst then
        return true;
    end

    InitTalkLists();

    -- ********* START DYNAMIC PART ********

    QuestID = 70;
    -- NPC by Magdha Tiefenerz, heavily revised by Estralis Seborian
    -- Queststatus Overview
    -- 0: No Quest taken
    -- 1: Quest 1 taken - gather 10 bundle of grain for 50cp
    -- 2: Quest 1 solved
    -- 3: Quest 2 taken - gather 20 tomatoes for 100cp
    -- 4: Quest 2 solved
    -- 5: Quest 3 taken - gather 5 onions for 100cp
    -- 6: Quest 3 solved
    -- 7: Quest 4 taken - gather 10 salmon fish for 200cp
    -- 8: Quest 4 solved
    -- Debugging
    AddTraderTrigger("set 0","Quest status set to 0");
    AddConsequence("qpg","=",0);
    AddTraderTrigger("set 1","Quest status set to 1");
    AddConsequence("qpg","=",1);
    AddTraderTrigger("set 2","Quest status set to 2");
    AddConsequence("qpg","=",2);
    AddTraderTrigger("set 3","Quest status set to 3");
    AddConsequence("qpg","=",3);
    AddTraderTrigger("set 4","Quest status set to 4");
    AddConsequence("qpg","=",4);
    AddTraderTrigger("set 5","Quest status set to 5");
    AddConsequence("qpg","=",5);
    AddTraderTrigger("set 6","Quest status set to 6");
    AddConsequence("qpg","=",6);
    AddTraderTrigger("set 7","Quest status set to 7");
    AddConsequence("qpg","=",7);
    AddTraderTrigger("set 8","Quest status set to 8");
    AddConsequence("qpg","=",8);
    -- Help
    AddTraderTrigger("Help","");
    AddConsequence("inform","[Game Help] This NPC is the cook Nana Winterbutter. Keyphrases: Hello, quest, bowl, cook, cooking.");
    AddTraderTrigger("Hilfe","");
    AddConsequence("inform","[Spielhilfe] Dieser NPC ist die Köchin Nana Winterbutter. Schlüsselwörter: Hallo, Quest, Schüssel, Koch, Kochen.");
    -- General speech
    AddTraderTrigger("Hello","Greetings! Maybe you could help me with a recipe.");
    AddAdditionalTrigger("Greetings");
    AddAdditionalTrigger("Be greeted");
    AddAdditionalTrigger("Hail");
    AddAdditionalTrigger("Good day");
    AddAdditionalTrigger("Good morning");
    AddAdditionalTrigger("Good evening");
    AddTraderTrigger("Grüße","Seid gegrüßt! Vielleicht könntet Ihr mir bei einem Rezept helfen.");
    AddAdditionalTrigger("Gruß");
    AddAdditionalTrigger("Seid gegrüßt");
    AddAdditionalTrigger("Guten Tag");
    AddAdditionalTrigger("Guten Abend");
    AddAdditionalTrigger("Mahlzeit");
    AddAdditionalTrigger("Tach");
    AddAdditionalTrigger("Moin");
    AddTraderTrigger("Hiho","Greetings! Maybe you could help me with a recipe.");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger("Greebs");
    AddCondition("lang","english");
    AddTraderTrigger("Hiho","Seid gegrüßt! Vielleicht könntet Ihr mir bei einem Rezept helfen.");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger("Greebs");
    AddCondition("lang","german");
    AddTraderTrigger("Farewell","Farewell!");
    AddAdditionalTrigger("Good bye");
    AddAdditionalTrigger("Bye");
    AddAdditionalTrigger("Fare thy well");
    AddAdditionalText("Oldra's blessing!");
    AddAdditionalText("Come back soon!");
    AddTraderTrigger("Tschüß","Auf Wiedersehen!");
    AddAdditionalTrigger("Tschüss");
    AddAdditionalTrigger("Wiedersehen");
    AddAdditionalTrigger("Gehabt euch wohl");
    AddAdditionalText("Oldras Segen!");
    AddAdditionalText("Kommt bald wieder!");
    AddTraderTrigger("Ciao","Farewell!");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","english");
    AddAdditionalText("Oldra's blessing!");
    AddAdditionalText("Come back soon!");
    AddTraderTrigger("Ciao","Auf Wiedersehen!");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","german");
    AddAdditionalText("Oldras Segen!");
    AddAdditionalText("Kommt bald wieder!");
    AddTraderTrigger("How are you","I'm fine.");
    AddAdditionalTrigger("How feel");
    AddAdditionalTrigger("How do you do");
    AddAdditionalText("Thank you very much!");
    AddAdditionalText("Well, I have this recipe in mind, which I would like to try.");
    AddTraderTrigger("Wie geht","Mir geht es gut.");
    AddAdditionalTrigger("Wie fühlst");
    AddAdditionalTrigger("Wie ist es ergangen");
    AddAdditionalText("Vielen Dank!");
    AddAdditionalText("Nun, ich habe dieses Rezept im Kopf, welches ich gerne ausprobieren würde.");
    AddTraderTrigger("your name","I am Nana Winterbutter.");
    AddAdditionalTrigger("who are you");
    AddAdditionalTrigger("who art thou");
    AddAdditionalText("I'm a cook as you might have noticed. And a good one I might add");
    AddTraderTrigger("dein name","Ich bin Nana Winterbutter.");
    AddAdditionalTrigger("wer bist du");
    AddAdditionalTrigger("wer seid ihr");
    AddAdditionalTrigger("wie heißt");
    AddAdditionalText("Ich bin eine Köchin, wie Ihr vielleicht bereits bemerkt habt. Und eine gute, wenn ich das hinzufügen darf.");
    -- Catching typical NPC phrases
    AddTraderTrigger("what sell","Sorry, I don't sell anything. But there are other people in Runewick. Some may even sell things to you.");
    AddAdditionalTrigger("what buy");
    AddAdditionalTrigger("list wares");
    AddAdditionalTrigger("price of");
    AddTraderTrigger("was verkauf","Tut mir leid, ich verkaufe nichts. Aber es gibt andere Leute in Runewick. Einige verkaufen Euch vielleicht auch etwas.");
    AddAdditionalTrigger("was kauf");
    AddAdditionalTrigger("warenliste");
    AddAdditionalTrigger("preis von");
    AddTraderTrigger("tell something","I'm not much of a storyteller.");
    AddAdditionalText("I'm just a cook. I would rather try out my new recipe instead of telling stories.");
    AddTraderTrigger("erzähl was","Ich bin nicht gerade eine gute Geschichtenerzählerin.");
    AddAdditionalTrigger("erzähl etwas");
    AddAdditionalText("Ich bin nur eine Köchin. Ich würde viel lieber mein Rezept ausprobieren, als Geschichten zu erzählen.");
    -- Small talk: The talk here should focus on possible questions. Feel free to add more!
    AddTraderTrigger("cook","Yes, I'm a good cook. I just use the best materials for cooking. Right now I would like to try out this new recipe.");
    AddTraderTrigger("Koch","Ich bin eine gute Köchin. Ich verwende nur die besten Zutaten zum Kochen. Im Moment würde ich gerne dieses neue Rezept ausprobieren.");
    AddAdditionalTrigger("Köchin");
    AddTraderTrigger("Yewdale","Yewdale is a peaceful place.");
    AddTraderTrigger("Eibenthal","Eibenthal ist ein friedlicher Ort.");
    AddAdditionalTrigger("Eibental");
    -- Factions
    AddTraderTrigger("Runewick","Runewick ist wundervoll. Und ich bin eine der besten Köchinnen hier.");
    AddCondition("lang","german");
    AddTraderTrigger("Runewick","Runewick is wonderful. And I'm one of the best cooks around here.");
    AddCondition("lang","english");
    AddTraderTrigger("Galmair","Ohje! Galmair ist so stinkig und dreckig!");
    AddCondition("lang","german");
    AddTraderTrigger("Galmair","Oh! Galmair is so smelly and dirty!");
    AddCondition("lang","english");
    AddTraderTrigger("Cadomyr","Ich war noch nie in Cadomyr. Aber ich hab gehört, es liegt im Süden.");
    AddCondition("lang","german");
    AddTraderTrigger("Cadomyr","I have never visited Cadomyr myself so far. But I have heard that it is to the south.");
    AddCondition("lang","english");
    -- Tool hints
    AddTraderTrigger("recipe","I have this special recipe in mind. I don't want to reveal too much about it but I would be grateful if you could help me with a quest.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("Rezept","Ich habe dieses besondere Rezept im Kopf. Ich möchte nicht zu viel darüber verraten, aber ich wäre dankbar, wenn Ihr mir bei einer Aufgabe helfen würdet.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("bowl","I'm preparing some dough but it won't last. Maybe you can help me with this quest.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("Schüssel","Ich rühre etwas Teig an aber der wird nicht reichen. Vielleicht könnt Ihr mir ja bei dieser Aufgabe helfen.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("scythe","You can use the scythe to reap wheat once it has this nice golden colour.");
    AddTraderTrigger("Sense","Ihr könnt eine Sense dafür verwenden, um Getreide zu mähen sobald es diese goldene Farbe hat.");
    AddTraderTrigger("sickle","You can use a sickle to collect vegetables once they are ripe. Or you can use it to collect herbs and mushrooms");
    AddTraderTrigger("Sichel","Ihr könnt eine Sichel verwenden um Gemüse einzusammeln sobald es reif ist. Oder Ihr verwendet sie um Kräuter und Pilze zu sammeln.");
    -- 1st quest: Take a tool and gather 10 bundles of grain for 50cp 
    AddTraderTrigger("quest","For my recipe, I need wheat. Please take this this scythe and get me ten bundles of grain. I will then handpick the grain from the spikes myself.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",0);
    AddCondition("lang","english");
    AddConsequence("item",271,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[New quest] Yewdale I");
    AddTraderTrigger("quest","Für mein Rezept brauche ich Weizen. Bitte nehmt diese Sense und bringt mir zehn Getreidebündel. Ich werde dann selbst die Samen von Hand aus den Ähren lesen.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",0);
    AddCondition("lang","german");
    AddConsequence("item",271,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[Neues Quest] Eibenthal I");
    AddTraderTrigger("task","For my recipe, I need wheat. Please take this this scythe and get me ten bundles of grain. I will then handpick the grain from the spikes myself.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",0);
    AddConsequence("item",271,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[New quest] Yewdale I");
    AddTraderTrigger("Auftrag","Für mein Rezept brauche ich Weizen. Bitte nehmt diese Sense und bringt mir zehn Getreidebündel. Ich werde dann selbst die Samen von Hand aus den Ähren lesen.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",0);
    AddConsequence("item",271,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[Neues Quest] Eibenthal I");
    AddTraderTrigger("recipe","It is very kind of you to get me ten bundles of grain. Please return to me and tell me when you are finished.");
    AddAdditionalTrigger("bowl");
    AddCondition("qpg","=",1);
    AddTraderTrigger("Rezept","Es ist sehr nett von Euch mir zehn Getreidebündel zu besorgen. Kehrt bitte zu mir zurück und sagt mir, wenn Ihr fertig seid.");
    AddAdditionalTrigger("Schüssel");
    AddCondition("qpg","=",1);
    AddTraderTrigger("quest","It is very kind of you to get me ten bundles of grain. Please return to me and tell me when you are finished.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",1);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Es ist sehr nett von Euch mir zehn Getreidebündel zu besorgen. Kehrt bitte zu mir zurück und sagt mir, wenn Ihr fertig seid.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",1);
    AddCondition("lang","german");
    AddTraderTrigger("task","It is very kind of you to get me ten bundles of grain. Please return to me and tell me when you are finished.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",1);
    AddTraderTrigger("Auftrag","Es ist sehr nett von Euch mir zehn Getreidebündel zu besorgen. Kehrt bitte zu mir zurück und sagt mir, wenn Ihr fertig seid.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",1);
    AddTraderTrigger(".+","Ja, das sollte ausreichend feines Getreide sein. Vielen herzlichen Dank! Bitte nehmt diese Kupfermünzen als Zeichen meiner Dankbarkeit.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all",">",9);
    AddCondition("town","=","runewick");
    AddCondition("lang","german");
    AddConsequence("deleteitem",249,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 50 Kupferstücke und deine Landwirtschaftsfertigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    AddConsequence("rankpoints","runewick","+",5);
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Yes, this should give plenty of fine grain. Thank you very much! Please take these copper coins as a sign of my gratitude.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all",">",9);
    AddCondition("town","=","runewick");
    AddCondition("lang","english");
    AddConsequence("deleteitem",249,10);
    AddConsequence("inform","[Quest solved] You are awarded 50 copper coins and your peasantry skill increases. You advance in Archmage Elvaine Morgan's favour.");
    AddConsequence("rankpoints","runewick","+",5);
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Ja, das sollte ausreichend feines Getreide sein. Vielen herzlichen Dank! Bitte nehmt diese Kupfermünzen als Zeichen meiner Dankbarkeit.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all",">",9);
    AddCondition("lang","german");
    AddConsequence("deleteitem",249,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 50 Kupferstücke und deine Landwirtschaftsfertigkeit steigt.");
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Yes, this should give plenty of fine grain. Thank you very much! Please take these copper coins as a sign of my gratitude.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all",">",9);
    AddCondition("lang","english");
    AddConsequence("deleteitem",249,10);
    AddConsequence("inform","[Quest solved] You are awarded 50 copper coins and your peasantry skill increases.");
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Es ist sehr nett von Euch mir zehn Getreidebündel zu besorgen. Kehrt bitte zu mir zurück und sagt mir, wenn Ihr fertig seid.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all","<",10);
    AddCondition("lang","german");
    AddTraderTrigger(".+","It is very kind of you to get me ten bundles of grain. Please return to me and tell me when you are finished.");
    AddCondition("qpg","=",1);
    AddCondition("item",249,"all","<",10);
    AddCondition("lang","english");
    -- 2nd quest: Gather 20 tomatoes for 100cp 
    AddTraderTrigger("recipe","Well, since you helped me before I might even tell you about the recipe. I think about fish in a crust with tomato sauce. But I don't have enough tomatoes and might need your help with this task again.");
    AddAdditionalTrigger("bowl");
    AddCondition("qpg","=",2);
    AddTraderTrigger("Rezept","Nun, da Ihr mir schon zuvor geholfen habt, kann ich Euch auch etwas über das Rezept sagen. Ich denke da an Fisch im Teigmantel mit Tomatensoße. Aber ich habe nicht genug Tomaten und könnte erneut Eure Hilfe bei dieser Aufgabe gebrauchen.");
    AddAdditionalTrigger("Schüssel");
    AddCondition("qpg","=",2);
    AddTraderTrigger("quest","I'd like to cook fish in a crust with tomato sauce. I need twenty tomatoes for the sauce to the fish. Care to help me?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",2);
    AddCondition("lang","english");
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[New quest] Yewdale II");
    AddTraderTrigger("quest","I möchte Fisch im Teigmantel mit Tomatensoße kochen. Ich brauchen zwanzig Tomaten für die Soße. Könnt ihr mir helfen?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",2);
    AddCondition("lang","german");
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[Neues Quest] Eibenthal II");
    AddTraderTrigger("task","I'd like to cook fish in a crust with tomato sauce. I need twenty tomatoes for the sauce to the fish. Care to help me?");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",2);
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[New quest] Yewdale II");
    AddTraderTrigger("Auftrag","I möchte Fisch im Teigmantel mit Tomatensoße kochen. Ich brauchen zwanzig Tomaten für die Soße. Könnt ihr mir helfen?");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",2);
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[Neues Quest] Eibenthal II");
    AddTraderTrigger("quest","Please bring me twenty tomatoes for my sauce.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",3);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Bitte bringt mir zwanzig Tomaten für meine Soße.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",3);
    AddCondition("lang","german");
    AddTraderTrigger("task","Please bring me twenty tomatoes for my sauce.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",3);
    AddTraderTrigger("Auftrag","Bitte bringt mir zwanzig Tomaten für meine Soße.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",3);
    AddTraderTrigger(".+","Großartig! Zwanzig reife Tomaten. Das wird in der Tat eine feine Soße ergeben. Bitte nehmt diese Kupfermünzen. Aber mein Gericht ist noch nicht fertig.");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all",">",19);
    AddCondition("town","=","runewick");
    AddCondition("lang","german");
    AddConsequence("deleteitem",200,20);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Landwirtschaftsfertigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    AddConsequence("rankpoints","runewick","+",10);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Great! Twenty ripe tomatoes. That will give a very fine sauce indeed. Please take these copper coins. But my recipe is still not finished.");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all",">",19);
    AddCondition("town","=","runewick");
    AddCondition("lang","english");
    AddConsequence("deleteitem",200,20);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your peasantry skill increases. You advance in Archmage Elvaine Morgan's favour.");
    AddConsequence("rankpoints","runewick","+",10);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Großartig! Zwanzig reife Tomaten. Das wird in der Tat eine feine Soße ergeben. Bitte nehmt diese Kupfermünzen. Aber mein Gericht ist noch nicht fertig.");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all",">",19);
    AddCondition("lang","german");
    AddConsequence("deleteitem",200,20);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Landwirtschaftsfertigkeit steigt.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Great! Twenty ripe tomatoes. That will give a very fine sauce indeed. Please take these copper coins. But my recipe is still not finished.");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all",">",19);
    AddCondition("lang","english");
    AddConsequence("deleteitem",200,20);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your peasantry skill increases.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Würdet Ihr mir bitte zwanzig Tomaten bringen? Ich danke Euch vielmals!");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all","<",20);
    AddCondition("lang","german");
    AddTraderTrigger(".+","Would you please bring me twenty tomatoes? I thank you very much!");
    AddCondition("qpg","=",3);
    AddCondition("item",200,"all","<",20);
    AddCondition("lang","english");
    -- 3rd quest: Gather onions for 100cp 
    AddTraderTrigger("recipe","You've helped with my recipe quite a lot so far. Please, don't think that I'm ungrateful, but I might have another task for you.");
    AddAdditionalTrigger("bowl");
    AddCondition("qpg","=",4);
    AddTraderTrigger("Rezept","Ihr habt mir schon sehr bei meinem Rezept geholfen. Bitte, denkt nicht, dass ich undankbar bin, aber ich hätte da noch eine Aufgabe für Euch.");
    AddAdditionalTrigger("Schüssel");
    AddCondition("qpg","=",4);
    AddTraderTrigger("quest","I think some onions would spice up the sauce. See if you can find at least five onions, please.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",4);
    AddCondition("lang","english");
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[New quest] Yewdale III");
    AddTraderTrigger("quest","Ich denke, ein paar Zwiebeln würden die Soße etwas aufpeppen. Versucht bitte, mindestens fünf Zwiebeln zu finden.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",4);
    AddCondition("lang","german");
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[Neues Quest] Eibenthal III");
    AddTraderTrigger("task","I think some onions would spice up the sauce. See if you can find at least five onions, please.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",4);
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[New quest] Yewdale III");
    AddTraderTrigger("Auftrag","Ich denke, ein paar Zwiebeln würden die Soße etwas aufpeppen. Versucht bitte, mindestens fünf Zwiebeln zu finden.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",4);
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[Neues Quest] Eibenthal III");
    AddTraderTrigger("quest","I hope you are able to find at least five onions so that I can spice up my sauce.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",5);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Ich hoffe Ihr könnt mindestens fünf Zwiebeln finden, so dass ich meine Soße etwas aufpeppen kann.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",5);
    AddCondition("lang","german");
    AddTraderTrigger("task","I hope you are able to find at least five onions so that I can spice up my sauce.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",5);
    AddTraderTrigger("Auftrag","Ich hoffe Ihr könnt mindestens fünf Zwiebeln finden, so dass ich meine Soße etwas aufpeppen kann.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",5);
    AddTraderTrigger(".+","Fantastisch! Ihr habt wirklich fünf Zwiebeln auftreiben können. Hier, nehmt ein paar Kupferstücke im Austausch. Aber wie peinlich, ich habe nun ein Problem mit dem Rezept.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all",">",4);
    AddCondition("town","=","runewick");
    AddCondition("lang","german");
    AddConsequence("deleteitem",201,5);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Landwirtschaftsfertigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    AddConsequence("rankpoints","runewick","+",15);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Fantastic! You've really managed to come up with five onions. Here, have some copper coins. But how embarrassing, I have a probem with the recipe now.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all",">",4);
    AddCondition("town","=","runewick");
    AddCondition("lang","english");
    AddConsequence("deleteitem",201,5);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your peasantry skill increases. You advance in Archmage Elvaine Morgan's favour.");
    AddConsequence("rankpoints","runewick","+",15);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Fantastisch! Ihr habt wirklich fünf Zwiebeln auftreiben können. Hier, nehmt ein paar Kupferstücke im Austausch. Aber wie peinlich, ich habe nun ein Problem mit dem Rezept.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all",">",4);
    AddCondition("lang","german");
    AddConsequence("deleteitem",201,5);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Landwirtschaftsfertigkeit steigt.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Fantastic! You've really managed to come up with five onions. Here, have some copper coins. But how embarrassing, I have a probem with the recipe now.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all",">",4);
    AddCondition("lang","english");
    AddConsequence("deleteitem",201,5);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your peasantry skill increases.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Ich weiß, dass sie schwer zu finden sind, aber ich bräuchte mindestens fünf Zwiebeln.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all","<",5);
    AddCondition("lang","german");
    AddTraderTrigger(".+","I know that they are hard to find but I would need at least five onions.");
    AddCondition("qpg","=",5);
    AddCondition("item",201,"all","<",5);
    AddCondition("lang","english");
    -- 4th quest: Gather 10 salmon fish for 200cp. Link to Fishing quest in Zzyathis. Hint how to get there.
    AddTraderTrigger("problem","How embarrassing! I was not careful enough with storing the fish for my recipe and now it is rotten. I hope that you can help me one last time with the task to get new fish.");
    AddCondition("qpg","=",6);
    AddCondition("lang","english");
    AddTraderTrigger("Problem","Wie peinlich! Ich war bei der Lagerung des Fisch, den ich verwenden will, nicht sorgfältig genug und nun ist er verdorben. Ich hoffe, Ihr helft mir ein letztes Mal bei der Besorgung von neuem Fisch.");
    AddCondition("qpg","=",6);
    AddCondition("lang","german");
    AddTraderTrigger("recipe","How embarrassing! I was not careful enough with storing the fish for my recipe and now it is rotten. I hope that you can help me one last time with the task to get new fish.");
    AddAdditionalTrigger("bowl");
    AddCondition("qpg","=",6);
    AddTraderTrigger("Rezept","Wie peinlich! Ich war bei der Lagerung des Fisch, den ich verwenden will, nicht sorgfältig genug und nun ist er verdorben. Ich hoffe, Ihr helft mir ein letztes Mal bei der Besorgung von neuem Fisch.");
    AddAdditionalTrigger("Schüssel");
    AddCondition("qpg","=",6);
    AddTraderTrigger("quest","I usually buy fish from Zerarisa. I am really sorry, but I always forget what this fish is called. But I need ten of these fish again.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",6);
    AddCondition("lang","english");
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[New quest] Yewdale IV");
    AddTraderTrigger("quest","Normalerweise kaufe ich Fisch von Zerarisa. Tut mir wirklich leid, aber ich vergesse immer, wie dieser Fisch heißt. Aber ich bräuchte wieder zehn von diesen Fischen.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",6);
    AddCondition("lang","german");
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[Neues Quest] Eibenthal IV");
    AddTraderTrigger("task","I usually buy fish from Zerarisa. I am really sorry, but I always forget what this fish is called. But I need ten of these fish again.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",6);
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[New quest] Yewdale IV");
    AddTraderTrigger("Auftrag","Normalerweise kaufe ich Fisch von Zerarisa. Tut mir wirklich leid, aber ich vergesse immer, wie dieser Fisch heißt. Aber ich bräuchte wieder zehn von diesen Fischen.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",6);
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[Neues Quest] Eibenthal IV");
    AddTraderTrigger("Zerarisa","Oh, Zerarisa, she is one of the lizard people who live in Cadomyr at Cape Farewell. She comes to Runewick once a month to sell fish.");
    AddCondition("qpg","=",7);
    AddCondition("lang","english");
    AddTraderTrigger("Zerarisa","Oh, Zerarisa, sie ist eine von den Echsenleuten, die in Cadomyr am Kap des Abschiedes leben. Sie kommt einmal im Monat nach Runewick um Fisch zu verkaufen.");
    AddCondition("qpg","=",7);
    AddCondition("lang","german");
    AddTraderTrigger("quest","Habt Ihr schon mit Zerarisa über die Fische gesprochen, die ich normalerweise bei ihr kaufe? Ich brauche wirklich zehn von diesen Fischen, um mein Rezept auszuprobieren.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",7);
    AddCondition("lang","german");
    AddTraderTrigger("quest","Did you already speak to Zerarisa about the fish I usually buy from her? I really need ten of these fish to try out my recipe.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",7);
    AddCondition("lang","english");
    AddTraderTrigger("task","Did you already speak to Zerarisa about the fish I usually buy from her? I really need ten of these fish to try out my recipe.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",7);
    AddTraderTrigger("Auftrag","Habt Ihr schon mit Zerarisa über die Fische gesprochen, die ich normalerwiese bei ihr kaufe? Ich brauche wirklich zehn von diesen Fischen, um mein Rezept auszuprobieren.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",7);
    AddTraderTrigger("salmon","Salmon? Yes, that could be the name of the fish. Now that you mention it. I think Zerarisa mentioned that name. But I need ten salmons for my recipe.");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all","<",10);
    AddTraderTrigger("Lachs","Lachs? Ja, das könnte der Name des Fisches sein. Jetzt wo Ihr es erwähnt. Ich denke Zerarisa hat mal diesen Namen erwähnt. Aber ich brauche zehn Lachse für mein Rezept.");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all","<",10);
    AddTraderTrigger(".+","Wunderbar! Ja, dies ist genau der Fisch, den ich brauche. Hier, sie sind jedes Kupferstück wert. Ich bin so glücklich, dass ich jetzt alles für meine Rezpet habe. Möge Oldra Euch segnen!");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all",">",9);
    AddCondition("town","=","runewick");
    AddCondition("lang","german");
    AddConsequence("deleteitem",355,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 200 Kupferstücke und deine Landwirtschaftsfertigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    AddConsequence("rankpoints","runewick","+",20);
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Wonderful! Yes, this is exactly the fish I need. Here, this is more than worth the copper. I'm so happy that I have everything for my recipe now. May Oldra bless you!");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all",">",9);
    AddCondition("town","=","runewick");
    AddCondition("lang","english");
    AddConsequence("deleteitem",355,10);
    AddConsequence("inform","[Quest solved] You are awarded 200 copper coins and your peasantry skill increases. You advance in Archmage Elvaine Morgan's favour.");
    AddConsequence("rankpoints","runewick","+",20);
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Wunderbar! Ja, dies ist genau der Fisch, den ich brauche. Hier, sie sind jedes Kupferstück wert. Ich bin so glücklich, dass ich jetzt alles für meine Rezpet habe. Möge Oldra Euch segnen!");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all",">",9);
    AddCondition("lang","german");
    AddConsequence("deleteitem",355,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 200 Kupferstücke und deine Landwirtschaftsfertigkeit steigt.");
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Wonderful! Yes, this is exactly the fish I need. Here, this is more than worth the copper. I'm so happy that I have everything for my recipe now. May Oldra bless you!");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all",">",9);
    AddCondition("lang","english");
    AddConsequence("deleteitem",355,10);
    AddConsequence("inform","[Quest solved] You are awarded 200 copper coins and your peasantry skill increases.");
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","peasantry","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Ich brauche wirklich zehn von diesen Fischen, die mir Zerarisa normalerweise verkauft. Könntet Ihr die bitte für mich besorgen?");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all","<",10);
    AddCondition("lang","german");
    AddTraderTrigger(".+","I really need ten of the fish that Zerarisa usually sells me. Would you please get them for me?");
    AddCondition("qpg","=",7);
    AddCondition("item",355,"all","<",10);
    AddCondition("lang","english");
    -- Final dialogue: No more quests, just nice hints
    AddTraderTrigger("recipe","Thanks to you I finally have all the ingredients I need to try out my new recipe. I thank you with all my heart!");
    AddAdditionalTrigger("bowl");
    AddCondition("qpg","=",8);
    AddTraderTrigger("Rezept","Dank Euch habe ich endlich alle Zutaten zusammen, um mein neues Rezept auszuprobieren. Ich danke Euch von ganzem Herzen!");
    AddAdditionalTrigger("Schüssel");
    AddCondition("qpg","=",8);
    AddTraderTrigger("quest","You have already done way too much for me. I will always keep you in good memory. You are truly a hero to me! May Oldra bless you!");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",8);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Ihr habt bereits viel zu viel für mich getan. Ich werde Euch immer in guter Erinnerung behalten. Ihr seid wahrlich ein Held für mich! Möge Oldra Euch segnen!");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",8);
    AddCondition("lang","german");
    AddTraderTrigger("task","You have already done way too much for me. I will always keep you in good memory. You are truly a hero to me! May Oldra bless you!");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",8);
    AddTraderTrigger("Auftrag","Ihr habt bereits viel zu viel für mich getan. Ich werde Euch immer in guter Erinnerung behalten. Ihr seid wahrlich ein Held für mich! Möge Oldra Euch segnen!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",8);
    -- Last catch: Think about keyphrases the player might say and that are not caught until here
    AddTraderTrigger("Yes","Pardon, I don't understand what you are referring to.");
    AddAdditionalText("What do you mean with 'Yes'?");
    AddTraderTrigger("Ja","Verzeiht, aber ich verstehe nicht, worauf Ihr Euch bezieht.");
    AddAdditionalText("Was meint Ihr mit 'Ja'?");
    AddTraderTrigger("No","Pardon, I don't understand what you are referring to.");
    AddAdditionalText("What do you mean with 'No'?");
    AddTraderTrigger("Nein","Verzeiht, aber ich verstehe nicht, worauf Ihr Euch bezieht.");
    AddAdditionalText("Was meint Ihr mit 'Nein'?");
    AddTraderTrigger("grain","Grain can be used as seed or you can grind it to flour. Put the grain on fertile land and the crop will grow.");
    AddTraderTrigger("Getreide","Getreidekörner können als Saatgut verwendet werden oder man zermahlt sie zu Mehl. Gib die Saat auf fruchtbares Land und das Getreide wird wachsen.");
    AddAdditionalTrigger("Korn");
    AddAdditionalTrigger("Körner");
    AddTraderTrigger("tomato","You can put tomato seeds into fertile soil. Be sure to fasten the growing plants to poles so that it grows straight up.");
    AddTraderTrigger("Tomate","Ihr könnt Tomatensamen in fruchtbaren Boden geben. Geht sicher die heranwachsenden Pflanzen an Stangen zu befestigen, damit sie senkrecht nach oben wachsen.");
    AddTraderTrigger("mushroom","Mushrooms love shadowy places and can be found in forests. You will need a sharp sickle to gather them.");
    AddTraderTrigger("Pilze","Pilze lieben schattige Plätze und können in Wäldern gefunden werden. Ihr werdet eine scharfe Sichel brauchen, um sie zu sammeln.");
    AddAdditionalTrigger("Champignon");
    AddTraderTrigger("fish","I know how to prepare fish but it seems that I always forget how the fish are called. You better ask someone else if you want to know more about fish.");
    AddTraderTrigger("Fisch","Ich weiß wie man Fisch zubereitet, aber es scheint, als würde ich immer vergessen, wie die Fischen heißen.");
    AddTraderTrigger("onion","Onions are tasty, aren't they? But your breath turns... bah!");
    AddTraderTrigger("zwiebeln","Zwiebeln sind lecker, nicht wahr? Aber dein Atem... igitt!");
    -- Cycletext: Please add at least(!) five cycletext messages. The more, the better. You can use emotes (#me is green), too.
    AddCycleText("#me rührt etwas Teig in einer Schüssel in ihrem linken Arm um.","#me stirs some dough in a bowl in her left arm.");
    AddCycleText("#me starrt besorgt in die Schüssel in ihrem linken Arm.","#me stares worryingly into the bowl in her left arm.");
    AddCycleText("Das wird nie und nimmer reichen.","This won't never ever last.");
    AddCycleText("#me gießt vorsichtig etwas Wasser in Schüssel in ihrem linken Arm.","#me pours carefully some water into the bowl in her left arm.");
    AddCycleText("Vielleicht sollte ich doch etwas anderes kochen.","Maybe I should cook something else.");
    -- ********* END DYNAMIC PART ********
    TradSpeakLang={0,1};
    TradStdLang=0;

    increaseLangSkill(TradSpeakLang);
    thisNPC.activeLanguage=TradStdLang;

end

function nextCycle()  -- ~10 times per second
    initializeNpc();
    SpeakerCycle();
end

function receiveText(texttype, message, originator)
    if BasicNPCChecks(originator,2) then
        if LangOK(originator,TradSpeakLang) then
            TellSmallTalk(message,originator);
        else
            Confused(
               "#me sieht dich leicht verwirrt an",
               "#me looks at you a little confused"
            );
        end
    end
end