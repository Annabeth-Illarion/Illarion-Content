-- INSERT INTO npc VALUES (nextval('npc_seq'),0,-110,-400,0,4,false,'Rutrus','npc_rutrus.lua',0);

require("npcs.base.autonpcfunctions")

function useNPC(user,counter,param)
    thisNPC:increaseSkill(1,"common language",100);
    thisNPC:talkLanguage(CCharacter.say, CPlayer.german, "Finger weg!");
    thisNPC:talkLanguage(CCharacter.say, CPlayer.english, "Don't you touch me!");
end

function initializeNpc()
    if TraderFirst then
        return true;
    end

    InitTalkLists();

    -- ********* START DYNAMIC PART ********

    QuestID = 67;
    -- NPC by Jupiter, revised by Estralis Seborian
    -- Queststatus Overview
    -- 0: No Quest taken
    -- 1: Quest 1 taken - gather 10 raw materials for 50cp
    -- 2: Quest 1 solved
    -- 3: Quest 2 taken - gather 20 raw materials for 100cp
    -- 4: Quest 2 solved
    -- 5: Quest 3 taken - gather 5 rare raw materials for 100cp
    -- 6: Quest 3 solved
    -- 7: Quest 4 taken - gather 10 distant raw materials for 200cp
    -- 8: Quest 4 solved
    -- Debugging
    AddTraderTrigger("set 0","Quest status set to 0");
    AddConsequence("qpg","=",0);
    AddTraderTrigger("set 1","Quest status set to 1");
    AddConsequence("qpg","=",1);
    AddTraderTrigger("set 2","Quest status set to 2");
    AddConsequence("qpg","=",2);
    AddTraderTrigger("set 3","Quest status set to 3");
    AddConsequence("qpg","=",3);
    AddTraderTrigger("set 4","Quest status set to 4");
    AddConsequence("qpg","=",4);
    AddTraderTrigger("set 5","Quest status set to 5");
    AddConsequence("qpg","=",5);
    AddTraderTrigger("set 6","Quest status set to 6");
    AddConsequence("qpg","=",6);
    AddTraderTrigger("set 7","Quest status set to 7");
    AddConsequence("qpg","=",7);
    AddTraderTrigger("set 8","Quest status set to 8");
    AddConsequence("qpg","=",8);
    -- Help
    AddTraderTrigger("Help","");
    AddConsequence("inform","[Game Help] This NPC is the digger Rutrus. Keyphrases: Hello, quest, shovel, profession.");
    AddTraderTrigger("Hilfe","");
    AddConsequence("inform","[Spielhilfe] Dieser NPC ist der Gräber Rutrus. Schlüsselwörter: Hallo, Quest, Schaufel, Beruf.");
    -- General speech
    AddTraderTrigger("Hello","Hello, Hello.");
    AddAdditionalTrigger("Greetings");
    AddAdditionalTrigger("Be greeted");
    AddAdditionalTrigger("Hail");
    AddAdditionalTrigger("Good day");
    AddAdditionalTrigger("Good morning");
    AddAdditionalTrigger("Good evening");
    AddAdditionalText("You greet me and I greet back: Greetings!");
    AddAdditionalText("Good day.");
    AddAdditionalText("Welcome to this sandy area.");
    AddTraderTrigger("Grüße","Hallo, Hallo.");
    AddAdditionalTrigger("Gruß");
    AddAdditionalTrigger("Seid gegrüßt");
    AddAdditionalTrigger("Guten Tag");
    AddAdditionalTrigger("Guten Abend");
    AddAdditionalTrigger("Mahlzeit");
    AddAdditionalTrigger("Tach");
    AddAdditionalTrigger("Moin");
    AddAdditionalText("Du grüßt mich und ich grüße zurück: Grüße!");
    AddAdditionalText("Guten Tag.");
    AddAdditionalText("Willkommen in dieser sandigen Gegend.");
    AddTraderTrigger("Hiho","Hello, Hello.");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger("Greebs");
    AddCondition("lang","english");
    AddAdditionalText("You greet me and I greet back: Greetings!");
    AddAdditionalText("Good day.");
    AddAdditionalText("Welcome to this sandy area.");
    AddTraderTrigger("Hiho","Hallo, Hallo.");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger("Greebs");
    AddCondition("lang","german");
    AddAdditionalText("Du grüßt mich und ich grüße zurück: Grüße!");
    AddAdditionalText("Guten Tag.");
    AddAdditionalText("Willkommen in dieser sandigen Gegend.");
    AddTraderTrigger("Farewell","Have a nice day!");
    AddAdditionalTrigger("Good bye");
    AddAdditionalTrigger("Bye");
    AddAdditionalTrigger("Fare thy well");
    AddAdditionalText("Goodbye, goodbye, come back soon!");
    AddAdditionalText("Farewell, you friendly being!");
    AddTraderTrigger("Tschüß","Einen schönen Tag auch.");
    AddAdditionalTrigger("Tschüss");
    AddAdditionalTrigger("Wiedersehen");
    AddAdditionalTrigger("Gehabt euch wohl");
    AddAdditionalText("Leb wohl, leb wohl, komm bald wieder!");
    AddAdditionalText("Auf bald, du freundliches Wesen!");
    AddTraderTrigger("Ciao","Have a nice day!");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","english");
    AddAdditionalText("Goodbye, goodbye, come back soon!");
    AddAdditionalText("Farewell, you friendly being!");
    AddTraderTrigger("Ciao","Einen schönen Tag auch.");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","german");
    AddAdditionalText("Leb wohl, leb wohl, komm bald wieder!");
    AddAdditionalText("Auf bald, du freundliches Wesen!");
    AddTraderTrigger("How are you","I have a grain of sand in my eye - how would you feel?!");
    AddAdditionalTrigger("How feel");
    AddAdditionalTrigger("How do you do");
    AddAdditionalText("Fine, fine.");
    AddAdditionalText("I just can say: I hope you are feeling as good as I do!");
    AddTraderTrigger("Wie geht","Ich habe Sand ins Auge bekommen - wie würdest du dich fühlen?!");
    AddAdditionalTrigger("Wie fühlst");
    AddAdditionalTrigger("Wie ist es ergangen");
    AddAdditionalText("Gut, gut.");
    AddAdditionalText("Ich kann nur sagen, ich hoffe es geht dir so gut wie mir!");
    AddTraderTrigger("your name","I am Rutrus and who are you?");
    AddAdditionalTrigger("who are you");
    AddAdditionalTrigger("who art thou");
    AddAdditionalText("Be greeted, I am the digger Rutus.");
    AddAdditionalText("I am Rutrus and this here is my shovel.");
    AddTraderTrigger("dein name","Ich bin Rutrus und wer bist du?");
    AddAdditionalTrigger("wer bist du");
    AddAdditionalTrigger("wer seid ihr");
    AddAdditionalTrigger("wie heißt");
    AddAdditionalText("Grüße dich, ich bin der Gräber Rutrus.");
    AddAdditionalText("Ich bin Rutrus und das in meinen Händen ist meine Schaufel.");
    -- Catching typical NPC phrases
    AddTraderTrigger("what sell","I'm not a trader but a digger!");
    AddAdditionalTrigger("what buy");
    AddAdditionalTrigger("list wares");
    AddAdditionalTrigger("price of");
    AddAdditionalText("I do not sell or buy anything, but I may have a quest for you.");
    AddAdditionalText("No trading! However, You could get some coins, if you do a task for me.");
    AddTraderTrigger("was verkauf","Ich bin kein Händler sondern ein Gräber!");
    AddAdditionalTrigger("was kauf");
    AddAdditionalTrigger("warenliste");
    AddAdditionalTrigger("preis von");
    AddAdditionalText("Ich kaufe und verkaufe nichts, aber ich habe vielleicht eine Aufgabe für dich.");
    AddAdditionalText("Kein Handel! Wie auch immer, du kannst ein paar Münzen bekommen, wenn du einen Auftrag erledigst.");
    AddTraderTrigger("tell something","We have to be very thankful that the shovel allows us to work with it.");
    AddAdditionalText("Without shovel no clay, without clay no bricks, without bricks no house! The shovel if the beginnig of everything.");
    AddAdditionalText("Dig next to rocks for sand. There you can find the best sand to make glass.");
    AddTraderTrigger("erzähl was","Wir müssen dankbar sein, dass die Schaufel uns das Arbeiten mit ihr erlaubt.");
    AddAdditionalTrigger("erzähl etwas");
    AddAdditionalText("Ohne Schaufel kein Lehm, ohne Lehm keine Ziegel, ohne Ziegel kein Haus! Die Schaufel ist der Anfang von Allem.");
    AddAdditionalText("Grabe neben Steinen nach Sand. Da findet du den besten Sand zum Glasmachen.");
    -- Small talk: The talk here should focus on possible questions. Feel free to add more!
    AddTraderTrigger("Profession","I'm a digger. I dig. I dig in the sand and where else you can dig.");
    AddAdditionalText("My job? I bring sand to glassblowers.");
    AddAdditionalText("I steal the sand from the desert.");
    AddTraderTrigger("Beruf","Ich bin Gräber. Ich grabe. Ich grabe im Sand und wo man sonst noch graben kann.");
    AddAdditionalText("Mein Beruf? Ich bringe Glasbläsern Sand.");
    AddAdditionalText("Ich stehle der Wüste den Sand.");
    AddTraderTrigger("oasis","This is the Oasis of Stars - a paradise for diggers.");
    AddAdditionalTrigger("desert");
    AddAdditionalText("The desert is a nice place, yes. But you need to watch out for scorpions.");
    AddAdditionalText("Welcome to the desert! If your throat gets try, you can visit the tavern.");
    AddTraderTrigger("oase","Dies ist die Sternenoase - ein Paradies für Sandgräber!");
    AddAdditionalTrigger("wüste");
    AddAdditionalText("Obgleich unsere Wüste ein schöner Ort ist, sollte man sich vor den Skorpionen hüten.");
    AddAdditionalText("Willkommen in der Wüste! Sollte deine Kehle mal zu trocken werden, schau doch in der Taverne vorbei.");
    AddTraderTrigger("Raban","Raban... I remember this name. It has been a while.");
    AddCondition("lang","english");
    AddTraderTrigger("Raban","Raban... Ich erinnere mich an diesen Namen. Lange ist's her.");
    AddCondition("lang","german");
    -- Factions
    AddTraderTrigger("Runewick","Ein verwunschener Ort. Traue keinem Elfen, sage ich.");
    AddCondition("lang","german");
    AddTraderTrigger("Runewick","A wicked place! Never trust an elf, I say.");
    AddCondition("lang","english");
    AddTraderTrigger("Galmair","What's that for a location?");
    AddCondition("lang","german");
    AddTraderTrigger("Galmair","Was soll das für ein Ort sein?");
    AddCondition("lang","english");
    AddTraderTrigger("Cadomyr","Die lassen mich meist alleine.");
    AddCondition("lang","german");
    AddAdditionalText("Manchmal gehe ich nach Cadomyr um meine Schaufel reparieren zu lassen.");
    AddTraderTrigger("Cadomyr","They leave me alone, usually.");
    AddCondition("lang","english");
    AddAdditionalText("From time to time, I go to Cadomyr to get my shovel fixed.");
    -- Tool hints
    AddTraderTrigger("Tool","The shovel is my tool. It seems to be a normal thing, but it is powerful in the right hands. I will give you one if you do a little task for me.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("Werkzeug","Mein Werkzeug ist die Schaufel. Sie scheint gewöhnlich, aber in richtigen Händen ist sie mächtig. Ich gebe dir eine, wenn du Aufgaben für mich erledigst.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("Schaufel","Werkzeug");
    AddTraderTrigger("shovel","The shovel is my tool. It seems to be a normal thing, but it is powerful in the right hands. I will give you one if you do a little task for me.");
    -- 1st quest: Take a tool and gather 10 raw materials for 50cp.
    AddTraderTrigger("quest","Oh! You want to help me? Take this shovel and get ten piles of coarse sand. Dig for it next to the rocks in the desert. Your reward will be fifty copper coins.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",0);
    AddCondition("lang","english");
    AddConsequence("item",24,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[New quest] Oasis of Stars I");
    AddTraderTrigger("quest","Oh! Du willst mir helfen? Nehme diese Schaufel hier und beschaffe mir zehn Haufen groben Sand. Grabe neben Steinen in der Wüste. Dein Lohn sollen fünfzig Kupferlinge sein.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",0);
    AddCondition("lang","german");
    AddConsequence("item",24,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[Neues Quest] Sternenoase I");
    AddTraderTrigger("task","Oh! You want to help me? Take this shovel and get ten piles of coarse sand. Dig for it next to the rocks in the desert. Your reward will be fifty copper coins. Oh");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",0);
    AddConsequence("item",24,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[New quest] Oasis of Stars I");
    AddTraderTrigger("Auftrag","! Du willst mir helfen? Nehme diese Schaufel hier und beschaffe mir zehn Haufen groben Sand. Grabe neben Steinen in der Wüste. Dein Lohn sollen fünfzig Kupferlinge sein.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",0);
    AddConsequence("item",24,1,399,0);
    AddConsequence("qpg","=",1);
    AddConsequence("inform","[Neues Quest] Sternenoase I");
    AddTraderTrigger("quest","You want to help me? Just bring me ten piles of coarse sand and you'll get fourty copper coins.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",1);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Oh! Du willst mir helfen? Bringe mir zehn Haufen groben Sand und dein Lohn sollen vierzig Kupferlinge sein.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",1);
    AddCondition("lang","german");
    AddTraderTrigger("task","You want to help me? Just bring me ten piles of coarse sand and you'll get fourty copper coins.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",1);
    AddTraderTrigger("Auftrag","Oh! Du willst mir helfen? Bringe mir zehn Haufen groben Sand und dein Lohn sollen vierzig Kupferlinge sein.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",1);
    AddTraderTrigger(".+","Oh, hoho! Das hast du toll gemacht. Hier deine versprochene Belohung. Solltest du noch eine Aufgabe wollen, sag es.");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all",">",9);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","german");
    AddConsequence("deleteitem",726,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 50 Kupferstücke und deine Bergbaufertigkeit steigt. Dein Ansehen bei Königin Rosaline Edwards steigt.");
    AddConsequence("rankpoints","cadomyr","+",5);
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Oh, hoho! Great job, my friend. Here is the reward I promised you. Just tell me, if you want an other task.");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all",">",9);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","english");
    AddConsequence("deleteitem",726,10);
    AddConsequence("inform","[Quest solved] You are awarded 50 copper coins and your mining skill increases. You advance in Queen Rosaline Edwards's favour.");
    AddConsequence("rankpoints","cadomyr","+",5);
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Oh, hoho! Das hast du toll gemacht. Hier deine versprochene Belohung. Solltest du noch eine Aufgabe wollen, sag es.");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all",">",9);
    AddCondition("lang","german");
    AddConsequence("deleteitem",726,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 50 Kupferstücke und deine Bergbaufertigkeit steigt.");
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Oh, hoho! Great job, my friend. Here is the reward I promised you. Just tell me, if you want an other task.");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all",">",9);
    AddCondition("lang","english");
    AddConsequence("deleteitem",726,10);
    AddConsequence("inform","[Quest solved] You are awarded 50 copper coins and your mining skill increases.");
    AddConsequence("money","+",50);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",2);
    AddTraderTrigger(".+","Ich sagte, du sollest zehn Haufen groben Sand bringen! Zurück in die Wüste, husch!");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all","<",10);
    AddCondition("lang","german");
    AddTraderTrigger(".+","I told you to bring me ten piles of coarse sand! Back into the desert!");
    AddCondition("qpg","=",1);
    AddCondition("item",726,"all","<",10);
    AddCondition("lang","english");
    -- 2nd quest: Gather 20 different raw materials for 100cp.
    AddTraderTrigger("quest","Another task? Alright, listen: I need twenty piles of quartz sand. First of all you need to get the coarse sand and then you need to filter it with a sieve. You will earn a hundred coppercoins.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",2);
    AddCondition("lang","english");
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[New quest] Oasis of Stars II");
    AddTraderTrigger("quest","Du willst eine weitere Aufgabe? Hör zu: I brauche zwanzig Haufen Quartzsand. Zuerst musst du groben Sand sammeln und diesen dann mit einem Sieb filtern. Du wirst hundert Kupferlinge zum Lohn erhalten.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",2);
    AddCondition("lang","german");
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[Neues Quest] Sternenoase II");
    AddTraderTrigger("task","Another task? Alright, listen: I need twenty piles of quartz sand. First of all you need to get the coarse sand and then you need to filter it with a sieve. You will earn a hundred coppercoins.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",2);
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[New quest] Oasis of Stars II");
    AddTraderTrigger("Auftrag","Du willst eine weitere Aufgabe? Hör zu: I brauche zwanzig Haufen Quartzsand. Zuerst musst du groben Sand sammeln und diesen dann mit einem Sieb filtern. Du wirst hundert Kupferlinge zum Lohn erhalten.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",2);
    AddConsequence("qpg","=",3);
    AddConsequence("inform","[Neues Quest] Sternenoase II");
    AddTraderTrigger("quest","Another task? I need twenty piles of quartz sand. First of all you need to get the coarse sand and then you need to filter it with a sieve. You will earn eighty coppercoins.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",3);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Du willst eine weitere Aufgabe? I brauche zwanzig Haufen Quartzsand. Zuerst musst du groben Sand sammeln und diesen dann mit einem Sieb filtern. Du wirst achtzig Kupferlinge zum Lohn erhalten.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",3);
    AddCondition("lang","german");
    AddTraderTrigger("task","Another task? I need twenty piles of quartz sand. First of all you need to get the coarse sand and then you need to filter it with a sieve. You will earn eighty coppercoins.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",3);
    AddTraderTrigger("Auftrag","Du willst eine weitere Aufgabe? Ich brauche zwanzig Haufen Quartzsand. Zuerst musst du groben Sand sammeln und diesen dann mit einem Sieb filtern. Du wirst achtzig Kupferlinge zum Lohn erhalten.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",3);
    AddTraderTrigger(".+","Das ist doch mal feiner Sand. Und hier hast du dein Geld.");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all",">",19);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","german");
    AddConsequence("deleteitem",316,20);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Bergbaufertigkeit steigt. Dein Ansehen bei Königin Rosaline Edwards steigt.");
    AddConsequence("rankpoints","cadomyr","+",10);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","This is what I call fine sand. And here is your money.");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all",">",19);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","english");
    AddConsequence("deleteitem",316,20);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your mining skill increases. You advance in Queen Rosaline Edwards's favour.");
    AddConsequence("rankpoints","cadomyr","+",10);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Das ist doch mal feiner Sand. Und hier hast du dein Geld.");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all",">",19);
    AddCondition("lang","german");
    AddConsequence("deleteitem",316,20);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Bergbaufertigkeit steigt.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","This is what I call fine sand. And here is your money.");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all",">",19);
    AddCondition("lang","english");
    AddConsequence("deleteitem",316,20);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your mining skill increases.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",4);
    AddTraderTrigger(".+","Ich will meine zwanzig Haufen Quartzsand!");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all","<",20);
    AddCondition("lang","german");
    AddTraderTrigger(".+","I want my twenty piles of quartz sand!");
    AddCondition("qpg","=",3);
    AddCondition("item",316,"all","<",20);
    AddCondition("lang","english");
    -- 3rd quest: Gather 5 rare raw materials for 100cp.
    AddTraderTrigger("quest","I need your help again. But this time it is a bit more complicated. I want you to collect five raw topaz and your reward will be a hundred coppercoins!");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",4);
    AddCondition("lang","english");
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[New quest] Oasis of Stars III");
    AddTraderTrigger("quest","Ich brauche wieder deine Hilfe. Dieses ist es etwas schwerer. Du sollst fünf ungeschliffene Topaze sammeln und dein Lohn sollen hundert Kupferlinge sein!");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",4);
    AddCondition("lang","german");
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[Neues Quest] Sternenoase III");
    AddTraderTrigger("task","I need your help again. But this time it is a bit more complicated. I want you to collect five raw topaz and your reward will be a hundred coppercoins!");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",4);
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[New quest] Oasis of Stars III");
    AddTraderTrigger("Auftrag","Ich brauche wieder deine Hilfe. Dieses ist es etwas schwerer. Du sollst fünf ungeschliffene Topaze sammeln und dein Lohn sollen hundert Kupferlinge sein!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",4);
    AddConsequence("qpg","=",5);
    AddConsequence("inform","[Neues Quest] Sternenoase III");
    AddTraderTrigger("quest","I need you to collect five raw topaz. Could you... dig on?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",5);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Ich brauche dich, um fünf ungeschliffene Topaze zu sammeln. Buddel weiter!");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",5);
    AddCondition("lang","german");
    AddTraderTrigger("task","I need you to collect five raw topaz. Could you... dig on?");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",5);
    AddTraderTrigger("Auftrag","Ich brauche dich, um fünf ungeschliffene Topaze zu sammeln. Buddel weiter!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",5);
    AddTraderTrigger(".+","Du hast tatsächlich ungeschliffene Topaze gefunden? Großartig! Hier, dein Lohn.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all",">",4);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","german");
    AddConsequence("deleteitem",257,5);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Bergbaufertigkeit steigt. Dein Ansehen bei Königin Rosaline Edwards steigt.");
    AddConsequence("rankpoints","cadomyr","+",15);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","You really found raw topaz? Great! Here you go.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all",">",4);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","english");
    AddConsequence("deleteitem",257,5);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your mining skill increases. You advance in Queen Rosaline Edwards's favour.");
    AddConsequence("rankpoints","cadomyr","+",15);
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Du hast tatsächlich ungeschliffene Topaze gefunden? Großartig! Hier, dein Lohn.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all",">",4);
    AddCondition("lang","german");
    AddConsequence("deleteitem",257,5);
    AddConsequence("inform","[Quest gelöst] Du erhältst 100 Kupferstücke und deine Bergbaufertigkeit steigt.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","You really found raw topaz? Great! Here you go.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all",">",4);
    AddCondition("lang","english");
    AddConsequence("deleteitem",257,5);
    AddConsequence("inform","[Quest solved] You are awarded 100 copper coins and your mining skill increases.");
    AddConsequence("money","+",100);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",6);
    AddTraderTrigger(".+","Das sind aber nicht genug Topaze. Da musst du wohl noch ein bisschen graben.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all","<",5);
    AddCondition("lang","german");
    AddTraderTrigger(".+","You don't have enough topaz yet. It seems that you need to dig some more.");
    AddCondition("qpg","=",5);
    AddCondition("item",257,"all","<",5);
    AddCondition("lang","english");
    -- 4th quest: Gather 10 raw materials from a totally different location for 200cp. Link to other quest. Hint how to get there.
    AddTraderTrigger("quest","You are a hardworking one. I'd like to have a barbeque, all alone with my shovel. Can you bring me ten lumps of coal from the Dark Hole mine for two hundred copper coins?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",6);
    AddCondition("lang","english");
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[New quest] Oasis of Stars IV");
    AddTraderTrigger("quest","Dich nenne ich fleißig! Ich würde gerne für meine Schaufel eine kleine Grillfeier schmeißen. Kannst du mir zehn Kohleklumpen für zweihundert Kupferstücke aus der Dunkellochmine bringen?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",6);
    AddCondition("lang","german");
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[Neues Quest] Sternenoase IV");
    AddTraderTrigger("task","You are a hardworking one. I'd like to have a barbeque, all alone with my shovel. Can you bring me ten lumps of coal from the Dark Hole mine for two hundred copper coins?");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",6);
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[New quest] Oasis of Stars IV");
    AddTraderTrigger("Auftrag","Dich nenne ich fleißig! Ich würde gerne für meine Schaufel eine kleine Grillfeier schmeißen. Kannst du mir zehn Kohleklumpen für zweihundert Kupferstücke aus der Dunkellochmine bringen?");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",6);
    AddConsequence("qpg","=",7);
    AddConsequence("inform","[Neues Quest] Sternenoase IV");
    AddTraderTrigger("quest","You are a hardworking one. I'd like to have a barbeque, all alone with my shovel. Can you bring me ten lumps of coal from the Dark Hole mine for two hundred copper coins?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",7);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Dich nenne ich fleißig! Ich würde gerne für meine Schaufel eine kleine Grillfeier schmeißen. Kannst du mir zehn Kohleklumpen für zweihundert Kupferstücke aus der Silberbrandmine bringen?");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",7);
    AddCondition("lang","german");
    AddTraderTrigger("task","You are a hardworking one. I'd like to have a barbeque, all alone with my shovel. Can you bring me ten lumps of coal from the Dark Hole mine for two hundred copper coins?");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",7);
    AddTraderTrigger("Auftrag","Dich nenne ich fleißig! Ich würde gerne für meine Schaufel eine kleine Grillfeier schmeißen. Kannst du mir zehn Kohleklumpen für zweihundert Kupferstücke aus der Dunkellochmine bringen?");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",7);
    AddTraderTrigger(".+","Ha! You did it great - just like all the other tasks. You were a big help and here are your coins. I'll place a sausage over the fire later on for you, my friend.");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all",">",9);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","english");
    AddConsequence("deleteitem",21,10);
    AddConsequence("inform","[Quest solved] You are awarded 200 copper coins and your mining skill increases. You advance in Queen Rosaline Edwards's favour.");
    AddConsequence("rankpoints","cadomyr","+",20);
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Ha! Das hast du großartig gemacht - wie auch alle anderen Aufgaben. Du warst eine große Hilfe und hier ist dein Lohn. Ich werde nachher eine Extrawurst für dich auf den Grill packen, mein Freund.");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all",">",9);
    AddCondition("town","=","cadomyr");
    AddCondition("lang","german");
    AddConsequence("deleteitem",21,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 200 Kupferstücke und deine Bergbaufertigkeit steigt. Dein Ansehen bei Königin Rosaline Edwards steigt.");
    AddConsequence("rankpoints","cadomyr","+",20);
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Ha! You did it great - just like all the other tasks. You were a big help and here are your coins. I'll place a sausage over the fire later on for you, my friend.");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all",">",9);
    AddCondition("lang","english");
    AddConsequence("deleteitem",21,10);
    AddConsequence("inform","[Quest solved] You are awarded 200 copper coins and your mining skill increases.");
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Ha! Das hast du großartig gemacht - wie auch alle anderen Aufgaben. Du warst eine große Hilfe und hier ist dein Lohn. Ich werde nachher eine Extrawurst für dich auf den Grill packen, mein Freund.");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all",">",9);
    AddCondition("lang","german");
    AddConsequence("deleteitem",21,10);
    AddConsequence("inform","[Quest gelöst] Du erhältst 200 Kupferstücke und deine Bergbaufertigkeit steigt.");
    AddConsequence("money","+",200);
    AddConsequence("skill","crafting","mining","+",1);
    AddConsequence("qpg","=",8);
    AddTraderTrigger(".+","Zehn Klumpen Kohle - Das kann doch nicht so schwer sein!");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all","<",10);
    AddCondition("lang","german");
    AddTraderTrigger(".+","Ten lumps of coal - shouldn't be too difficult, eh?");
    AddCondition("qpg","=",7);
    AddCondition("item",21,"all","<",10);
    AddCondition("lang","english");
    -- Final dialogue: No more quests, just nice hints
    AddTraderTrigger("quest","You helped me enough, really. I have no other jobs for you. But maybe you can find someone in the Dark Hole mine who will give you something to do. And remember: The shovel is your friend.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",8);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Du hast mir genug geholfen, wirklich. Ich habe keine Aufgaben mehr für dich. Aber vielleicht findest du in der Dunkellochmine jemanden, der etwas für dich zu tun hat. Und denk daran: Die Schaufel ist dein Freund.");
    AddAdditionalTrigger("mission");
    AddCondition("qpg","=",8);
    AddCondition("lang","german");
    AddTraderTrigger("task","You helped me enough, really. I have no other jobs for you. But maybe you can find someone in the Dark Hole mine who will give you something to do. And remember: The shovel is your friend.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",8);
    AddTraderTrigger("Auftrag","Du hast mir genug geholfen, wirklich. Ich habe keine Aufgaben mehr für dich. Aber vielleicht findest du in der Dunkellochmine jemanden, der etwas für dich zu tun hat. Und denk daran: Die Schaufel ist dein Freund.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",8);
    -- Cycletext: Please add at least(!) five cycletext messages. The more, the better. You can use emotes (#me is green), too.
    AddCycleText("#me streicht sich durch das Haar und lässt so einige Sandkörner herumfliegen.","#me strokes through his hair and a few grains of sand fly around.");
    AddCycleText("#me säubert seine Schaufel.","#me cleans his shovel. ");
    AddCycleText("Na warte, Wüste. Ich grabe so lange, bis du erledigt bist!","Just wait, desert. I continue digging until you are gone!");
    AddCycleText("#me lässt seinen Blick durch die Gegend wandern, während er sich auf seiner Schaufel abstützt.","#me leans on his shovel and looks around.");
    AddCycleText("Ein Mann ohne Schaufel ist nur ein halber Mann.","A man without a shovel is just half a man.");
    AddCycleText("#me murmelt etwas zu seiner Schaufel.","#me murmurs to his shovel.");
    AddCycleText("#me beginnt, ein Loch im Sand auszuheben.","#me starts to dig a hole.");
    -- ********* END DYNAMIC PART ********
    TradSpeakLang={0,1};
    TradStdLang=0;

    increaseLangSkill(TradSpeakLang);
    thisNPC.activeLanguage=TradStdLang;

end

function nextCycle()  -- ~10 times per second
    initializeNpc();
    SpeakerCycle();
end

function receiveText(texttype, message, originator)
    if BasicNPCChecks(originator,2) then
        if LangOK(originator,TradSpeakLang) then
            TellSmallTalk(message,originator);
        else
            Confused(
               "#me sieht dich leicht verwirrt an",
               "#me looks at you a little confused"
            );
        end
    end
end