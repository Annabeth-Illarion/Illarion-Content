-- INSERT INTO npc VALUES (nextval('npc_seq'),1,-5,-137,0,4,false,'Saren Eisenfaust','npc_saren_eisenfaust.lua',0);

require("npcs.base.autonpcfunctions")

function useNPC(user,counter,param)
    thisNPC:increaseSkill(1,"common language",100);
    thisNPC:talkLanguage(CCharacter.say, CPlayer.german, "Finger weg!");
    thisNPC:talkLanguage(CCharacter.say, CPlayer.english, "Don't you touch me!");
end

function initializeNpc()
    if TraderFirst then
        return true;
    end

    InitTalkLists();

    -- ********* START DYNAMIC PART ********

    SetRadius(0);
    QuestID = 0;
    -- Queststatus Overview 
    -- 0: No Quest taken 
    -- 1: Quest 1 taken - gather 10 raw materials of two different kinds and 1 needed tools for +5 skill while skill<=20 
    -- 2: Quest 1 solved 
    -- 3: Quest 2 taken - gather 15 raw materials, 2 differnt tools and 5 semi finished products for +5 skill while 20<=40 
    -- 4: Quest 2 solved 
    -- 5: Quest 3 taken - gather 4 needed tools, 10 semi finished products of 2 kinds and 5 easy finished products for +5 skill while 40<=60 
    -- 6: Quest 3 solved 
    -- 7: Quest 4 taken - gather 15 semi finished products, 10 easy finished products of 2 kinds and 5 advanced finished products for skill+5 while 60<=80 
    -- 8: Quest 4 solved 
    -- Cycletext:
    AddCycleText("#me streicht sich über seinen langen Bart.","#me uncurls his long beard.");
    AddCycleText("#me blickt sich mistrauisch in der Höhle um und kratzt sich anschließend breit grinsend am Hintern.","#me looks around suspeciously through the cave and afterwards scratchs his buttocks grinning broadly.");
    AddCycleText("#me nimmt eine Bierflasche aus seiner Tasche und trinkt einen Schluck","#me takes a beer bottle out of his bag and takes a mouthful.");
    AddCycleText("#me wischt sich den Schweiß von der Stirn, als er die Arbeit unterbricht","#me wipes the sweat off his forehead, when he intterupts his work.");
    AddCycleText("#me brummt leise etwas in seinen Bart als er beim Schmieden auf seinen Finger schlägt","#me grumbles something into his beard when he hits his finger with his hammer.");
    -- Help 
    AddTraderTrigger("Help","[Game Help] This NPC is the smith Saren Eisenfaust. Keyphrases: Hello, quest, pickaxe, adventure");
    AddTraderTrigger("Hilfe","[Spielhilfe] Dieser NPC ist der Schmied Saren Eisenfaust. Schlüsselwörter: Hallo, Quest, Aufgaben, Spitzhacke");
    -- General speech 
    AddTraderTrigger("greetings","Good day, what do ya want?");
    AddAdditionalTrigger("hello");
    AddAdditionalTrigger("huhu");
    AddAdditionalTrigger("good evening");
    AddAdditionalTrigger("good day");
    AddAdditionalTrigger("good morning");
    AddAdditionalText("Irmorom with ya, do ya need anything?");
    AddTraderTrigger("grüße","Tach auch, wat gibts?");
    AddAdditionalTrigger("huhu");
    AddAdditionalTrigger("Tach");
    AddAdditionalTrigger("Guten Abend");
    AddAdditionalTrigger("Guten Morgen");
    AddAdditionalTrigger("Guten Tag");
    AddAdditionalText("Irmorom zum Gruße, brauchst du wat?");
    AddTraderTrigger("Hiho","What do ya want, eh? We say greetings around here.");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger(",english");
    AddAdditionalText("Aye, whatever.");
    AddAdditionalText("You won't come far with that, that's greetings around here.");
    AddTraderTrigger("Hiho","Wat willste, eh? Dat heißt Tach!");
    AddAdditionalTrigger("Hallo");
    AddAdditionalTrigger("Hey");
    AddAdditionalTrigger("Greebas");
    AddAdditionalTrigger(",german");
    AddAdditionalText("Aye, wat auch immer.");
    AddAdditionalText("Damit kommste hier nich weit, es heißt Tach!");
    AddTraderTrigger("Ciao","Eh..what did you just say about my mother?");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","english");
    AddAdditionalText("What are you jabbering about?");
    AddAdditionalText("Nah, I don't wanna buy that!");
    AddTraderTrigger("Ciao","Eh..wat hast du grad über meine Mutter gesagt?");
    AddAdditionalTrigger("Adieu");
    AddAdditionalTrigger("Au revoir");
    AddCondition("lang","german");
    AddAdditionalText("Wat quasselst du da?");
    AddAdditionalText("Nay, ich will dat nich kaufen!");
    AddTraderTrigger("who are you","I'm Saran and who are you?");
    AddAdditionalTrigger("whats your name");
    AddAdditionalTrigger("your name");
    AddAdditionalText("I'm called Saran, Saran Eisenfaust and what's your name?");
    AddTraderTrigger("wer bist du","Ich bin der Saren und wer bist du?");
    AddAdditionalTrigger("wer seid ihr");
    AddAdditionalTrigger("wie heißt du");
    AddAdditionalTrigger("dein name");
    AddAdditionalText("Man nennt mich Saren, Saren Eisenfaust und wie nennt man dich?");
    AddTraderTrigger("Farewell","Aye, take care.");
    AddAdditionalTrigger("good bye");
    AddAdditionalTrigger("bye");
    AddAdditionalTrigger("see you");
    AddAdditionalText("Irmorom with ya!");
    AddAdditionalText("Until next time!");
    AddTraderTrigger("Auf bald","Aye, machs gut.");
    AddAdditionalTrigger("Tschüß");
    AddAdditionalTrigger("Wiedersehen");
    AddAdditionalTrigger("Machs gut");
    AddAdditionalTrigger("Bis dann");
    AddAdditionalTrigger("Bis später");
    AddAdditionalTrigger("Schönen Tag noch");
    AddAdditionalText("Irmorom mit dir!");
    AddAdditionalText("Man sieht sich.");
    AddTraderTrigger("how are you","Can't say that something's bothering me and ya?");
    AddAdditionalTrigger("how feel");
    AddAdditionalTrigger("how do you do");
    AddAdditionalText("So-so, but I'm fine right now.");
    AddTraderTrigger("wie gehts","Ich kann nich klagen und du?");
    AddAdditionalTrigger("wie fühlst");
    AddAdditionalText("Ganz gut und selbst?");
    AddAdditionalText("Mal so, mal so, aber gerade geht es mir ganz gut.");
    -- Catching typical NPC phrases 
    AddTraderTrigger("what sell","Do I looks like a merchant? I don't think so!");
    AddAdditionalTrigger("what buy");
    AddAdditionalTrigger("list wares");
    AddAdditionalTrigger("price of");
    AddAdditionalText("Nah, I don't buy anything and I won't ever sell something to you!");
    AddAdditionalText("Maybe some other time, not today.");
    AddTraderTrigger("was verkauf","Sehe ich aus wie ein Händler, ich denke nicht!");
    AddAdditionalTrigger("was kauf");
    AddAdditionalTrigger("warenliste");
    AddAdditionalTrigger("preis von");
    AddAdditionalText("Nay, ich kauf nix und verkaufen tu ich erst recht nix an dich!");
    AddAdditionalText("Ein ander mal vielleicht, heute nich.");
    -- Small talk
    AddTraderTrigger("profession","You ask what my profession is? I'm a smith, the best even.");
    AddCondition("lang","english");
    AddAdditionalText("I'm a smith and you?");
    AddTraderTrigger("Beruf","Du fragst nach meinem Beruf? Ich bin Schmied, einer der besten sogar.");
    AddCondition("lang","german");
    AddAdditionalText("Von Beruf bin ich Schmied und du?");
    AddTraderTrigger("location","You're in the mountains, where else?");
    AddCondition("lang","english");
    AddTraderTrigger("Ort","In den Bergen bist du hier, wo sonst?");
    AddCondition("lang","german");
    AddTraderTrigger("runewick","Runewick is the city full of that mage-folk right? Don't like them much.");
    AddCondition("lang","english");
    AddTraderTrigger("runewick","Runewick ist die Stadt mit diesem Magierpack, stimmts? Mag die nicht besonders.");
    AddCondition("lang","german");
    AddTraderTrigger("cadomyr","Well, a little hot there but the queen is supposed to be good looking, wouldn't mind if she came here.");
    AddCondition("lang","english");
    AddTraderTrigger("cadomyr","Nun, ein bisschen warm dort, aber die Königin soll gutaussehen. Würde nichts dagegen haben, wenn sie mal herkommt.");
    AddCondition("lang","german");
    AddTraderTrigger("galmair","Fine town, really fine town you know. But only if ya have enough silvercoins in your pocket you know what I mean?");
    AddCondition("lang","english");
    AddTraderTrigger("galmair","Tolle Stadt, wirklich tolle Stadt weißt du. Aber nur wenn du genug Silbermünzen in der Tasche hast, weißt du was ich meine?");
    AddCondition("lang","german");
    AddTraderTrigger("queen","Don't know her personally but wouldn't mind if she really is as good looking as they say. Told to be a harsh leader though.");
    AddTraderTrigger("königin","Kenn die nicht persönlich aber würde mich nicht weigern wenn sie wirklich so gut aussieht wie man sagt. Man sagt auch das sie eine taffe herrscherin is.");
    AddTraderTrigger("erzmagier","Kenn ich nicht, wer soll denn das sein?");
    AddTraderTrigger("archmage","Don't know him, who's that supposed to be?");
    AddTraderTrigger("don","Well, not much to say here. He's the leader of Galmair and does his job really good.");
    AddCondition("lang","english");
    AddTraderTrigger("don","Nun, gibt nicht viel zu sagen. Er ist der Anführer von Galmair und macht seine Arbeit sehr gut.");
    AddCondition("lang","german");
    -- Tool hints 
    AddTraderTrigger("pickaxe","You can mine for ore with it, a merchant can surely sell ya one if you lose yours.");
    AddCondition("qpg","=",0);
    AddTraderTrigger("Spitzhacke","Damit kannst du das Erz abbauen, ein Händler kann dir sicher eine verkaufen wenn du deine verlierst");
    AddCondition("qpg","=",0);
    -- 1st quest
    AddTraderTrigger("quest","I can help ya if ya wanna become a smith, but first bring me 10 lumps of coal aswell as 10 chunks of iron ore, and don't forget to bring a hammer. Here is a pickaxe for you to get the ore.");
    AddCondition("skill","smithing","=<",20);
    AddCondition("lang","english");
    AddConsequence("item",2763,1,399,0);
    AddConsequence("qpg","=",1);
    AddTraderTrigger("quest","Ich kann dir helfen falls du Schmied werden willst,  hol mir aber erstma 10 Brocken Kohle sowie 10 Klumpen Eisenerz und nen Hammer nich zu vergessen. Hier noch die Spitzhacke zum abbauen des Erzes.");
    AddCondition("skill","smithing","=<",20);
    AddCondition("lang","german");
    AddConsequence("item",2763,1,399,0);
    AddConsequence("qpg","=",1);
    AddTraderTrigger("task","I can help ya if ya wanna become a smith, but first bring me 10 lumps of coal aswell as 10 chunks of iron ore, and don't forget to bring a hammer. Here is a pickaxe for you to get the ore.");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing","=<",20);
    AddConsequence("item",2763,1,399,0);
    AddConsequence("qpg","=",1);
    AddTraderTrigger("Auftrag","Ich kann dir helfen, falls du Schmied werden willst, dafür solltest du mir aber erstma 10 Brocken Kohle sowie 10 Klumpen Eisenerz bringen. Und hier eine Hacke um das Erz abzubauen.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing","=<",20);
    AddConsequence("item",2763,1,399,0);
    AddConsequence("qpg","=",1);
    AddTraderTrigger("quest","I want ya to get 10 lumps of coal and 10 cunks of iron ore, and don't forget the hammer!");
    AddCondition("qpg","=",1);
    AddCondition("lang","english");
    AddTraderTrigger("quest","10 Brocken Kohle und 10 Klumpen Eisenerz will ich das du holst, vergiss aber auch nicht den Hammer");
    AddCondition("qpg","=",1);
    AddCondition("lang","german");
    AddTraderTrigger("task","Aye, 10 lumps of coal and 10 chunks of iron ore and a hammer, that's what I want.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",1);
    AddTraderTrigger("Auftrag","Aye, 10 Brocken Eisenerz, 10 Klumpen Kohle und nen Hammer is es wat ich haben will!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",1);
    AddTraderTrigger(".+","Arr, gut gemacht. Jetzt schau mir gut zu, damit du auch wat lernst!");
    AddCondition("qpg","=",1);
    AddCondition("item",21,"all",">",9);
    AddCondition("item",22,"all",">",9);
    AddCondition("item",23,"all",">",0);
    AddCondition("lang","german");
    AddConsequence("deleteitem",21,10);
    AddConsequence("deleteitem",22,10);
    AddConsequence("deleteitem",23,1);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",2);
    AddConsequence("inform","[Quest erfüllt!] Du hast das Gefühl als hättest du was dazu gelernt.");
    AddTraderTrigger(".+","Arr, good job. Now watch me, so that you actually learn something!");
    AddCondition("qpg","=",1);
    AddCondition("item",21,"all",">",9);
    AddCondition("item",22,"all",">",9);
    AddCondition("item",23,"all",">",0);
    AddCondition("lang","english");
    AddConsequence("deleteitem",21,10);
    AddConsequence("deleteitem",22,10);
    AddConsequence("deleteitem",23,1);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",2);
    AddConsequence("inform","[Quest finished!] You have the feeling as if you really learnt something.");
    AddTraderTrigger(".+","Arr, wenn du dir mit mir einen Spaß erlauben willst, werd ich dir nich helfen, ich sehe genau das du nich alles da hast wat ich haben wollte!");
    AddCondition("qpg","=",1);
    AddCondition("item",21,"all","<",10);
    AddCondition("item",22,"all","<",10);
    AddCondition("item",23,"all","<",1);
    AddCondition("lang","german");
    AddTraderTrigger(".+","Arr, if you try to trick me, I won't help you. I see that this is not everything that I wanted.");
    AddCondition("qpg","=",1);
    AddCondition("item",21,"all","<",10);
    AddCondition("item",22,"all","<",10);
    AddCondition("item",23,"all","<",1);
    AddCondition("lang","english");
    -- 2nd quest 
    AddTraderTrigger("quest","Aye, I have another task for ya. I need 15 copper ore, a new crucible, a fine smith hammer and 5 iron ingots!");
    AddCondition("skill","smithing",">",20);
    AddCondition("skill","smithing","=<",40);
    AddCondition("lang","english");
    AddConsequence("qpg","=",3);
    AddTraderTrigger("quest","Aye, hab wieder wat für dich zu tun. 15 Kupfererz, einen neuen Schmelztiegel, einen Feinschmiedehammer und 5 Eisenbarren brauch ich!");
    AddCondition("skill","smithing",">",20);
    AddCondition("skill","smithing","=<",40);
    AddCondition("lang","german");
    AddConsequence("qpg","=",3);
    AddTraderTrigger("task","Aye, I have another task for ya. I need 15 copper ore, a new crucible, a fine smith hammer and 5 iron ingots!");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing",">",20);
    AddCondition("skill","smithing","=<",40);
    AddConsequence("qpg","=",3);
    AddTraderTrigger("Auftrag","Aye, hab wieder wat für dich zu tun. 15 Kupfererz, einen neuen Schmelztiegel, einen Feinschmiedehammer und 5 Eisenbarren brauch ich!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing",">",20);
    AddCondition("skill","smithing","=<",40);
    AddConsequence("qpg","=",3);
    AddTraderTrigger("quest","Leave me be for now, I wanna smith something for me for a change. Come back later, alright?");
    AddCondition("qpg","=",2);
    AddCondition("skill","smithing","=<",20);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Lass mich mal in Ruhe, will auch selber mal wat schmieden. Kannst ja später wieder kommen, nich?");
    AddCondition("qpg","=",2);
    AddCondition("skill","smithing","=<",20);
    AddCondition("lang","german");
    AddTraderTrigger("task","Leave me be for now, I wanna smith something for me for a change. Come back later, alright?");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing","=<",20);
    AddCondition("qpg","=",2);
    AddTraderTrigger("Auftrag","Lass mich mal in Ruhe, will auch selber mal wat schmieden. Kannst ja später wieder kommen, nich?");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing","=<",20);
    AddCondition("qpg","=",2);
    AddTraderTrigger("quest","Ya're supposed to bring me 15 copper ore, a crucible, a fine smith hammer and 5 iron ingots. Not that hard to memorize, is it?");
    AddCondition("qpg","=",3);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Du sollst mir 15 Kupfererz, einen neuen Schmelztiegel, einen Feinschmiedehammer und 5 Eisenbarren bringen, is das so schwer zu merken,eh?");
    AddCondition("qpg","=",3);
    AddCondition("lang","german");
    AddTraderTrigger("task","Ya're supposed to bring me 15 copper ore, a crucible, a fine smith hammer and 5 iron ingots. Not that hard to memorize, is it?");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",3);
    AddTraderTrigger("Auftrag","Du sollst mir 15 Kupfererz, einen neuen Schmelztiegel, einen Feinschmiedehammer und 5 Eisenbarren bringen, is das so schwer zu merken,eh?");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",3);
    AddTraderTrigger(".+","Sieht gut aus, alles da wat ich von dir verlangt hab, scheint als könnt aus dir doch nen richtiger Schmied werden.");
    AddCondition("qpg","=",3);
    AddCondition("item",2536,"all",">",14);
    AddCondition("item",2535,"all",">",4);
    AddCondition("item",2699,"all",">",1);
    AddCondition("item",122,"all",">",1);
    AddCondition("lang","german");
    AddConsequence("deleteitem",2536,15);
    AddConsequence("deleteitem",25351,5);
    AddConsequence("deleteitem",2699,1);
    AddConsequence("deleteitem",122,1);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",4);
    AddConsequence("inform","[Quest erfüllt!] Du hast das Gefühl als hättest du was dazu gelernt.");
    AddTraderTrigger(".+","Looks good and even everything that I wanted ya to bring. Looks as if you could become a real smith after all.");
    AddCondition("qpg","=",3);
    AddCondition("item",2536,"all",">",14);
    AddCondition("item",2535,"all",">",4);
    AddCondition("item",2699,"all",">",1);
    AddCondition("item",122,"all",">",1);
    AddCondition("lang","english");
    AddConsequence("deleteitem",2536,15);
    AddConsequence("deleteitem",2535,5);
    AddConsequence("deleteitem",2699,1);
    AddConsequence("deleteitem",122,1);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",4);
    AddConsequence("inform","[Quest finished!] You have the feeling as if you really learnt something.");
    AddTraderTrigger(".+","Wie mir scheint, kann man sich nich auf dich verlassen. Oder du bist dümmer als du aussiehst, denn es is nich besonders schwer 15 Kupfererz, 5 Eisenbarren, einen Schmelztiegel und einen Feinschmiedehammer zu besorgen!");
    AddCondition("qpg","=",3);
    AddCondition("item",2356,"all","<",15);
    AddCondition("item",2535,"all","<",5);
    AddCondition("item",2699,"all","=",0);
    AddCondition("item",122,"all","=",0);
    AddCondition("lang","german");
    AddTraderTrigger(".+","It seems ya're not trustworthy after all, or maybe ya're just dumber that ya look, because you didn't bring me the 15 copper ore, 5 iron ingots, a crucible and a fine smith hammer.");
    AddCondition("qpg","=",3);
    AddCondition("item",2356,"all","<",15);
    AddCondition("item",2535,"all","<",5);
    AddCondition("item",2699,"all","=",0);
    AddCondition("item",122,"all","=",0);
    AddCondition("lang","english");
    -- 3rd quest
    AddTraderTrigger("quest","Ya're quiet good now. It's time to teach ya something real. Bring me 10 iron ingots, 10 copper ingots, 5 steel greaves and 4 pickaxes, than I'll show ya what a smith can do.");
    AddCondition("skill","smithing",">",40);
    AddCondition("skill","smithing","=<",60);
    AddCondition("lang","english");
    AddConsequence("qpg","=",5);
    AddTraderTrigger("quest","Du machst dich ganz gut. Nun wird es aber an der Zeit dir wat richtiges beizubringen. Bring mir zehn Eisenbarren, zehn Kupferbarren, fünf Stahlbeinschienen und vier Spitzhacken, dann siehst du selbst was ein Schmied so alles kann.");
    AddCondition("skill","smithing",">",40);
    AddCondition("skill","smithing","=<",60);
    AddCondition("lang","german");
    AddConsequence("qpg","=",5);
    AddTraderTrigger("task","Ya're quiet good now. It's time to teach ya something real. Bring me 10 iron ingots, 10 copper ingots, 5 steel greaves and 4 pickaxes, than I'll show ya what a smith can do.");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing",">",40);
    AddCondition("skill","smithing","=<",60);
    AddConsequence("qpg","=",5);
    AddTraderTrigger("Auftrag","Du machst dich ganz gut. Nun wird es aber an der Zeit dir wat richtiges beizubringen. Bring mir zehn Eisenbarren, zehn Goldbarren, fünf Kupferbarren und vier große Schwertgriffe, dann siehst du selbst was ein Schmied so alles kann.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing",">",40);
    AddCondition("skill","smithing","=<",60);
    AddConsequence("qpg","=",5);
    AddTraderTrigger("quest","Be gone, I have no time for ya right now and as it seems you didn't make any progress! Practice some more, than I'll show you how to smith some nice weapons.");
    AddCondition("qpg","=",4);
    AddCondition("skill","smithing","=<",40);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Verschwinde, ich hab grad keine Zeit und so wie du aussiehst, hast du eh keine Fortschritte gemacht! Übe mehr, dann zeig ich dir auch wie man ne nette Waffe schmiedet.");
    AddCondition("qpg","=",4);
    AddCondition("skill","smithing","=<",40);
    AddCondition("lang","german");
    AddTraderTrigger("task","Be gone, I have no time for ya right now and as it seems you didn't make any progress! Practice some more, than I'll show you how to smith some nice weapons.");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing","=<",40);
    AddCondition("qpg","=",4);
    AddTraderTrigger("Auftrag","Verschwinde, ich hab grad keine Zeit und so wie du aussiehst, hast du eh keine Fortschritte gemacht! Übe mehr, dann zeig ich dir auch wie man ne nette Waffe schmiedet.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing","=<",40);
    AddCondition("qpg","=",4);
    AddTraderTrigger("quest","It's 10 iron ingots, 10 copper ingots, 5 steel greaves and 4 pickaxes I wanted from you.");
    AddCondition("qpg","=",5);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Es waren zehn Eisenbarren, zehn Kupferbarren, fünf Stahlbeinschienen und vier Spitzhacken die ich haben wollt, aye!");
    AddCondition("qpg","=",5);
    AddCondition("lang","german");
    AddTraderTrigger("task","It's 10 iron ingots, 10 copper ingots, 5 steel greaves and 4 pickaxes I wanted from you.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",5);
    AddTraderTrigger("Auftrag","Es waren zehn Eisenbarren, zehn Kupferbarren, fünf Stahlbeinschienen und vier Spitzhacken die ich haben wollt, aye!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",5);
    AddTraderTrigger(".+","Endlich biste wieder zurück, ich hatte mir schon Sorgen gemacht. Nun pass aber auf wie ich die Erze kombiniere.");
    AddCondition("qpg","=",5);
    AddCondition("item",2763,"all",">",3);
    AddCondition("item",2535,"all",">",9);
    AddCondition("item",2550,"all",">",9);
    AddCondition("item",2176,"all",">",4);
    AddCondition("lang","german");
    AddConsequence("deleteitem",2763,4);
    AddConsequence("deleteitem",2535,10);
    AddConsequence("deleteitem",2550,10);
    AddConsequence("deleteitem",2176,5);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",6);
    AddConsequence("inform","[Quest erfüllt!] Du hast das Gefühl als hättest du was dazu gelernt.");
    AddTraderTrigger(".+","Finally, you're back, I started to worry about ya. Now watch me, how I combine those ore.");
    AddCondition("qpg","=",5);
    AddCondition("item",2763,"all",">",3);
    AddCondition("item",2535,"all",">",9);
    AddCondition("item",2550,"all",">",9);
    AddCondition("item",2176,"all",">",4);
    AddCondition("lang","english");
    AddConsequence("deleteitem",2763,4);
    AddConsequence("deleteitem",2535,10);
    AddConsequence("deleteitem",2550,10);
    AddConsequence("deleteitem",2176,5);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",6);
    AddConsequence("inform","[Quest finished!] You have the feeling as if you really learnt something.");
    AddTraderTrigger(".+","Wenn du nix lernen willst, dann mach das du verschwindest! Wenn du nichtmal die kleinsten Aufträge erfüllen willst, wie willste da nen guter Schmied werden?!");
    AddCondition("qpg","=",5);
    AddCondition("item",2763,"all","<",4);
    AddCondition("item",2535,"all","<",10);
    AddCondition("item",2550,"all","<",10);
    AddCondition("item",2176,"all","<",5);
    AddCondition("lang","german");
    AddTraderTrigger(".+","If ya don't wanna learn anything, just go. Ya don't even want to fulfill the simplest task, how do ya want to become a good smith than?!");
    AddCondition("qpg","=",5);
    AddCondition("item",2763,"all","<",4);
    AddCondition("item",2535,"all","<",10);
    AddCondition("item",2550,"all","<",10);
    AddCondition("item",2176,"all","<",5);
    AddCondition("lang","english");
    -- 4th quest
    AddTraderTrigger("quest","Never thought I would see your face again. But good that you ask, I need 15 copper ingots, 10 war hammer, 10 rapier and 2 steel plate.");
    AddCondition("skill","smithing",">",60);
    AddCondition("skill","smithing","=<",80);
    AddCondition("lang","english");
    AddConsequence("qpg","=",7);
    AddTraderTrigger("quest","Das ich dich mal wieder zu Gesicht bekomme hätte ich nich gedacht. Aber jut das du fragst. 15 Kupferbarren, 10 Kriegshämmer, 10 Degen und 2 Stahlharnische bräuchte ich von dir.");
    AddCondition("skill","smithing",">","60s");
    AddCondition("skill","smithing","=<",80);
    AddCondition("lang","german");
    AddConsequence("qpg","=",7);
    AddTraderTrigger("task","Never thought I would see your face again. But good that you ask, I need 15 copper ingots, 10 war hammer, 10 rapier and 2 steel plate.");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing",">",60);
    AddCondition("skill","smithing","=<",80);
    AddConsequence("qpg","=",7);
    AddTraderTrigger("Auftrag","Das ich dich mal wieder zu Gesicht bekomme hätte ich nich gedacht. Aber jut das du fragst. 15 Kupferbarren, 10 Kriegshämmer, 10 Degen und 2 Stahlharnische bräuchte ich von dir.");
    AddAdditionalTrigger("Aufgabe");
    AddCondition("skill","smithing",">",60);
    AddCondition("skill","smithing","=<",80);
    AddConsequence("qpg","=",7);
    AddTraderTrigger("quest","Come back later, I've no time for ya at the moment.");
    AddCondition("qpg","=",6);
    AddCondition("skill","smithing","=<",60);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Komm später wieder, ich hab im Moment keine Zeit für dich.");
    AddCondition("qpg","=",6);
    AddCondition("skill","smithing","=<",60);
    AddCondition("lang","german");
    AddTraderTrigger("task","Come back later, I've no time for ya at the moment.");
    AddAdditionalTrigger("adventure");
    AddCondition("skill","smithing","=<",60);
    AddCondition("qpg","=",6);
    AddTraderTrigger("Auftrag","Komm später wieder, ich hab im Moment keine Zeit für dich.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("skill","smithing","=<",60);
    AddCondition("qpg","=",6);
    AddTraderTrigger("quest","You were supposed to bring me 15 copper ingots, 10 war hammer, 10 rapier and 2 steel plate.");
    AddCondition("qpg","=",7);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Die Sachen die du mir bringen solltest waren 15 Kupferbarren, 10 Kriegshämmer, 10 Degen und 2 Stahlharnische.");
    AddCondition("qpg","=",7);
    AddCondition("lang","german");
    AddTraderTrigger("task","You were supposed to bring me 15 copper ingots, 10 war hammer, 10 rapier and 2 steel plate.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",7);
    AddTraderTrigger("Auftrag","Die Sachen die du mir bringen solltest waren 15 Kupferbarren, 10 Kriegshämmer, 10 Degen und 2 Stahlharnische.");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",7);
    AddTraderTrigger(".+","Sehr gut gemacht, ich wusste man kann sich auf dich verlassen. Nun sperr die Augen weit auf und beobachte wie ich dat Schwert schmiede!");
    AddCondition("qpg","=",7);
    AddCondition("item",2550,"all",">",14);
    AddCondition("item",2675,"all",">",9);
    AddCondition("item",226,"all",">",9);
    AddCondition("item",2364,"all",">",1);
    AddCondition("lang","german");
    AddConsequence("deleteitem",2550,15);
    AddConsequence("deleteitem",2675,10);
    AddConsequence("deleteitem",226,10);
    AddConsequence("deleteitem",2364,2);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",8);
    AddConsequence("inform","[Quest erfüllt!] Du hast das Gefühl als hättest du was dazu gelernt.");
    AddTraderTrigger(".+","");
    AddCondition("qpg","=",7);
    AddCondition("item",2550,"all",">",14);
    AddCondition("item",2675,"all",">",9);
    AddCondition("item",226,"all",">",9);
    AddCondition("item",2364,"all",">",1);
    AddCondition("lang","english");
    AddConsequence("deleteitem",2550,15);
    AddConsequence("deleteitem",2675,10);
    AddConsequence("deleteitem",226,10);
    AddConsequence("deleteitem",2364,2);
    AddConsequence("skill","crafting","smithing","+",5);
    AddConsequence("qpg","=",8);
    AddConsequence("inform","[Quest finished!] You have the feeling as if you really learnt something.");
    AddTraderTrigger(".+","Nay, ick red mit dir kein Wort mehr bist du mir nicht das bringst, was ich von dir haben wollte!");
    AddCondition("qpg","=",7);
    AddCondition("item",2550,"all","<",15);
    AddCondition("item",2675,"all","<",10);
    AddCondition("item",226,"all","<",10);
    AddCondition("item",2364,"all","<",2);
    AddCondition("lang","german");
    AddTraderTrigger(".+","Nah, I won't talk to ya until ya bring me the things I asked you for.");
    AddCondition("qpg","=",7);
    AddCondition("item",2550,"all","<",15);
    AddCondition("item",2675,"all","<",10);
    AddCondition("item",226,"all","<",10);
    AddCondition("item",2364,"all","<",2);
    AddCondition("lang","english");
    -- Final dialogue: No more quests, just nice hints 
    AddTraderTrigger("quest","Nah, you learnt enough from me. You have to find out everything else there is. That's what a good smith is all about.");
    AddCondition("qpg","=",8);
    AddCondition("lang","english");
    AddTraderTrigger("quest","Nay, ich glaub du hast genug von mir gelernt. Alles weitere musst du jetzt selber herausfinden, das macht einen guten Schmied aus!");
    AddCondition("qpg","=",8);
    AddCondition("lang","german");
    AddTraderTrigger("task","Nah, you learnt enough from me. You have to find out everything else there is. That's what a good smith is all about.");
    AddAdditionalTrigger("adventure");
    AddCondition("qpg","=",8);
    AddTraderTrigger("Auftrag","Nay, ich glaub du hast genug von mir gelernt. Alles weitere musst du jetzt selber herausfinden, das macht einen guten Schmied aus!");
    AddAdditionalTrigger("Aufgabe");
    AddAdditionalTrigger("Abenteuer");
    AddCondition("qpg","=",8);
    -- Last catch: Think about keyphrases the player might say and that are not caught until here 
    AddTraderTrigger("Yes","Aye, than go and collect those things I asked you for.");
    AddAdditionalText("If ya say so.");
    AddAdditionalText("Alright, have fun!");
    AddTraderTrigger("Ja","Aye, dann mach dich auf dem Weg und sammel was ich von dir wollte!");
    AddAdditionalText("Na wenn du meinst");
    AddAdditionalText("Is gut, viel Vergnügen!");
    AddTraderTrigger("No","What did ya say, I hope I didn't hear ya correctly?!");
    AddAdditionalText("You say no... no to me, what do ya think your speaking to?");
    AddAdditionalText("With that attitude, ya won't become a good smith.");
    AddTraderTrigger("Nein","Wat sachste, ich hoffe ich habe mich verhört?!");
    AddAdditionalText("Du sagst Nein...nein zu mir, wat denkst du mit wem du sprichst!");
    AddAdditionalText("Dann nich, so wird nie was aus dir!");
    -- ********* END DYNAMIC PART ********
    TradSpeakLang={0,1};
    TradStdLang=0;

    increaseLangSkill(TradSpeakLang);
    thisNPC.activeLanguage=TradStdLang;

end

function nextCycle()  -- ~10 times per second
    initializeNpc();
    SpeakerCycle();
end

function receiveText(texttype, message, originator)
    if BasicNPCChecks(originator,2) then
        if LangOK(originator,TradSpeakLang) then
            TellSmallTalk(message,originator);
        else
            Confused(
               "#me sieht dich leicht verwirrt an",
               "#me looks at you a little confused"
            );
        end
    end
end
