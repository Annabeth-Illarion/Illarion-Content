-- INSERT INTO npc VALUES (nextval('npc_seq'),2,-100,-420,0,4,false,'Lilith Needlehand','npc_lilith_needlehand.lua',1);

require("npcs.base.autonpcfunctions")
module("npcs.lilith_needlehand")

function useNPC(user,counter,param)
    thisNPC:increaseSkill(1,"common language",100);
    thisNPC:talkLanguage(CCharacter.say, CPlayer.german, "Finger weg!");
    thisNPC:talkLanguage(CCharacter.say, CPlayer.english, "Don't you touch me!");
end

function initializeNpc()
    if TraderFirst then
        return true;
    end

    npcs.base.autonpcfunctions.InitTalkLists();

    -- ********* START DYNAMIC PART ********

    QuestID = 73;
    -- Author: Vern Kron (PO Artimer Fault), heavily revised by Estralis Seborian
    -- Help
    npcs.base.autonpcfunctions.AddTraderTrigger("Help","");
    npcs.base.autonpcfunctions.AddConsequence("inform","[Game Help] This NPC is the tailor Lilith and may need help in a task. Keyphrases: Hello, Quest, Needle, Tailor.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Hilfe","");
    npcs.base.autonpcfunctions.AddConsequence("inform","[Spielhilfe] Dieser NPC ist die Schneiderin Lilith. Sie könnte Hilfe bei einer Aufgabe gebrauchen. Schlüsselwörter: Hallo, Quest, Nadel, Schneider.");
    -- General speech
    npcs.base.autonpcfunctions.AddTraderTrigger("Hello","Hiho! You must have come to help me!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Greetings");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Be greeted");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Hail");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Good day");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Good morning");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Good evening");
    npcs.base.autonpcfunctions.AddAdditionalText("Oh my, hello there! You are here to assist me, I assume.");
    npcs.base.autonpcfunctions.AddAdditionalText("#me gives a charming smile.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Grüße","Hiho! Du bist sicher hier, um mir zu helfen!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Gruß");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Seid gegrüßt");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Guten Tag");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Guten Abend");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Mahlzeit");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Tach");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Moin");
    npcs.base.autonpcfunctions.AddAdditionalText("Oh, hallo!");
    npcs.base.autonpcfunctions.AddAdditionalText("#me lächelt freundlich.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Hiho","Hiho! You must have come to help me!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Hallo");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Hey");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Greebas");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Greebs");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddAdditionalText("Oh my, hello there! You are here to assist me, I assume.");
    npcs.base.autonpcfunctions.AddAdditionalText("#me gives a charming smile.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Hiho","Hiho! Du bist sicher hier, um mir zu helfen!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Hallo");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Hey");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Greebas");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Greebs");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddAdditionalText("Oh, hallo! Du kannst mir bestimmt helfen.");
    npcs.base.autonpcfunctions.AddAdditionalText("#me lächelt freundlich.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Farewell","#me waves excitedly.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Good bye");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Bye");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Fare thy well");
    npcs.base.autonpcfunctions.AddAdditionalText("Good Bye!");
    npcs.base.autonpcfunctions.AddAdditionalText("Come back soon and maybe we can have some cake!");
    npcs.base.autonpcfunctions.AddAdditionalText("#me turns back to the sheep, saying over her shoulder 'Farewell' as she pets one.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Tschüß","#me winkt freudig zum Abschied.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Tschüss");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Wiedersehen");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Gehabt euch wohl");
    npcs.base.autonpcfunctions.AddAdditionalText("Auf wiedersehen!");
    npcs.base.autonpcfunctions.AddAdditionalText("Komm bald zurück und dann essen wir Kuchen!");
    npcs.base.autonpcfunctions.AddAdditionalText("#me wendet sich wieder den Schafen zu.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Ciao","#me waves excitedly.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Adieu");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Au revoir");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddAdditionalText("Good Bye!");
    npcs.base.autonpcfunctions.AddAdditionalText("Come back soon and maybe we can have some cake!");
    npcs.base.autonpcfunctions.AddAdditionalText("#me turns back to the sheep, saying over her shoulder 'Farewell' as she pets one.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Ciao","#me winkt freudig zum Abschied.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Adieu");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Au revoir");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddAdditionalText("Auf wiedersehen!");
    npcs.base.autonpcfunctions.AddAdditionalText("Komm bald zurück und dann essen wir Kuchen!");
    npcs.base.autonpcfunctions.AddAdditionalText("#me wendet sich wieder den Schafen zu.");
    npcs.base.autonpcfunctions.AddTraderTrigger("How are you","I'm in a hurry! The archmage ordered a robe and I didn't finish it yet.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("How feel");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("How do you do");
    npcs.base.autonpcfunctions.AddTraderTrigger("Wie geht","Ich bin in Eile. Der Erzmagier hat eine Robe bestellt und ich habe sie noch nicht fertig.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Wie fühlst");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Wie ist es ergangen");
    npcs.base.autonpcfunctions.AddTraderTrigger("your name","My name is Lilith Needlehand, and I am a tailor, and it is a pleasure to meet you!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("who are you");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("who art thou");
    npcs.base.autonpcfunctions.AddTraderTrigger("dein name","Mein Name ist Lilith Needlehand und ich bin eine Schneiderin. Es ist schön, deine Bekanntschaft zu machen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("wer bist du");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("wer seid ihr");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("wie heißt");
    -- Catching typical NPC phrases
    npcs.base.autonpcfunctions.AddTraderTrigger("what sell","I am not currently selling or buying anything. I need to finish an order first.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("what buy");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("list wares");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("price of");
    npcs.base.autonpcfunctions.AddTraderTrigger("was verkauf","Ich kaufe oder verkaufe derzeit nichts. Ich muss erstmal eine Bestellung fertig bekommen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("was kauf");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("warenliste");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("preis von");
    npcs.base.autonpcfunctions.AddTraderTrigger("tell something","Hrm? I don't know what you are talking about. Do you expect me to gossip like an old halfling woman?!");
    npcs.base.autonpcfunctions.AddTraderTrigger("erzähl was","Hrm? Worüber sprichst du? Soll ich dir dummes Zeug erzählen wie ein Waschweib?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("erzähl etwas");
    -- Small talk: The talk here should focus on possible questions. Feel free to add more!
    npcs.base.autonpcfunctions.AddTraderTrigger("Tailor","As a tailor, I use wool, thread, and dye to create clothes. Some people only wear armor, but for a fancy evening nothing beats a fancy robe or dress.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Schneider","Als Schneiderin mache ich Kleidung aus Wolle, Garn und Färbemittel. Einige Leute tragen den ganzen Tag ihre Rüstung, aber für einen schönen Abend gibt es nichts feineres als ein tolles Kleid.");
    npcs.base.autonpcfunctions.AddTraderTrigger("order","Oh dear, the archmage ordered a new robe. I totally forgot working on it! Maybe you can help me with this task.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Bestellung","Ohje, der Erzmagier hat eine neue Robe bestellt. Ich hab vollkommen vergessen, daran zu arbeiten. Vielleicht kannst du mir mit dieser Aufgabe helfen.");
    npcs.base.autonpcfunctions.AddTraderTrigger("robe","Oh dear, the archmage ordered a new robe. I totally forgot working on it! Maybe you can help me with this task.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Robe","Ohje, der Erzmagier hat eine neue Robe bestellt. Ich hab vollkommen vergessen, daran zu arbeiten. Vielleicht kannst du mir mit dieser Aufgabe helfen.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    -- Tool hints
    npcs.base.autonpcfunctions.AddTraderTrigger("needle","I use my needle to make clothes.");
    npcs.base.autonpcfunctions.AddTraderTrigger("Nadel","Mit meiner Nadel nähe ich Kleidung.");
    npcs.base.autonpcfunctions.AddTraderTrigger("scissors","To get scissors, I strongly suggest you talk to a smith, or you may purchase them from the nearby shop, I believe!");
    npcs.base.autonpcfunctions.AddTraderTrigger("Schere","Wenn du eine Schere brauchst, geh doch zu einem Schmied oder frag im Laden.");
    -- Faction stuff
    npcs.base.autonpcfunctions.AddTraderTrigger("Elvaine","Archmage Morgan, yes, I think he ordered a new robe. I should work on it!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Morgan");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("archmage");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Erzmagier");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Elvaine","Erzmagier Morgan, ja, der hat eine neue Robe bei mir bestellt. Ich sollte besser mal an ihr arbeiten.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Morgan");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("archmage");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Erzmagier");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("Runewick","This is Runewick! I personally enjoy it here.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Runewick","Dies hier ist Runewick. Mir gefällt es hier.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("Valerio","Ui, they have no law in Galmair, but everyone knows the Don is the boss.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Guilianni");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Don");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Valerio","Ui, es gibt kein Gesetz in Galmair, aber jeder weiß, dass der Don der Boss ist.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Guilianni");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Don");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("Galmair","Galmair is funny. I used to live there, but here, it is more pleasant.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Galmair","Galmair ist echt komisch. Ich hab da früher mal gelebt, aber hier ist es schöner.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("rosaline","A woman rules Cadomyr. That is so funny!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("königin");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("queen");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("edwards");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("rosaline","Eine Frau regiert Cadomyr. Das ist so lustig!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("königin");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("queen");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("edwards");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("Cadomyr","Cadomyr is far away, somewhere in the west I think. They don't like women there, but are ruled by a queen. Strange, eh?");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Cadomyr","Cadomyr ist weit weg, irgendwo im Westen meine ich. Die mögen keine Frauen da, aber trotzdem regiert da eine Königin. Komisch, oder?");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    -- Main land factions
    npcs.base.autonpcfunctions.AddTraderTrigger("albar","They are mad, those albarians.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("albar","Die spinnen, die Albarier.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("gynk","My aunt lives near Gynk. I always write her a letter, each month.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("gync");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("gync","Meine Tante lebt bei Gynk. Ich schreibe ihr jeden Monat einen Brief.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("gynk");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("salkama","The Archmage talks a lot about Salkamar, I know nothing about that.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("salkama","Der Erzmagier redet viel über Salkamar, ich weiß da nichts drüber.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    -- Gods; each NPC should at react on one god, being a follower of said god
    npcs.base.autonpcfunctions.AddTraderTrigger("Irmorom","Irmorom guides my needle. Sometimes, he's angry and I sting myself.");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("Irmorom","Irmorom führt meine Nadel. Manchmal ist er böse auf mich und dann picks ich mich.");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("Cherga","Eeek!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Moshran");
    -- 1st quest: Gather 20 wool
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","I could use some help at tailoring a robe for the archmage, yes! Please get me twenty pieces of wool, I am short on that.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",0);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",1);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress I");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Ich könnte etwas Hilfe gebrauchen, um eine Robe für den Erzmagier zu schneidern. Bring mir doch bitte zwanzig Wollballen, ich habe keine mehr.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",0);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",1);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein I");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","I could use some help at tailoring a robe for the archmage, yes! Please get me twenty pieces of wool, I am short on that.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",0);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",1);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress I");
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Ich könnte etwas Hilfe gebrauchen, um eine Robe für den Erzmagier zu schneidern. Bring mir doch bitte zwanzig Wollballen, ich habe keine mehr.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",0);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",1);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein I");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Did you forget? I need twenty bundles of wool! Oh please, I need to finish the robe for the archmage in time.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Hast du es schon vergessen? Ich brauche zwanzig Wollballen. Bitte, ich muss die Robe für den Erzmagier rechtzeitig fertig kriegen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","Did you forget? I need twenty bundles of wool! Oh please, I need to finish the robe for the archmage in time.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Hast du es schon vergessen? Ich brauche zwanzig Wollballen. Bitte, ich muss die Robe für den Erzmagier rechtzeitig fertig kriegen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Oh, danke! Ich habe keine Belohnung für dich, aber du kannst meine Ersatznadel haben.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all",">",19);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",170,20);
    npcs.base.autonpcfunctions.AddConsequence("item",47,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst eine Nadel und deine Schneidereifähigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",5);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",2);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Why thank you! I don't have a real reward for you, but you can have my spare needle.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all",">",19);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",170,20);
    npcs.base.autonpcfunctions.AddConsequence("item",47,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a needle and your tailoring skill increases. You advance in Archmage Elvaine Morgan's favour.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",5);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",2);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Oh, danke! Ich habe keine Belohnung für dich, aber du kannst meine Ersatznadel haben.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all",">",19);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",170,20);
    npcs.base.autonpcfunctions.AddConsequence("item",47,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst eine Nadel und deine Schneidereifähigkeit steigt.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",2);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Why thank you! I don't have a real reward for you, but you can have my spare needle.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all",">",19);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",170,20);
    npcs.base.autonpcfunctions.AddConsequence("item",47,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a needle and your tailoring skill increases.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",2);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Hmm, das ist noch nicht genug Wolle.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all","<",19);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Hrm.. there is not enough wool here yet.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",1);
    npcs.base.autonpcfunctions.AddCondition("item",170,"all","<",19);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    -- 2nd quest: Gather 15 thread
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Oh, you want to help me some more? Well, I certainly need some thread for the robe. Bring me fifteen bobbins of thread, please.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",2);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",3);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress II");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Oh, du willst mir noch mehr helfen? Nun, ich werde sicherlich einiges an Garn für die Robe brauchen. Bring mir doch bitte fünfzehn Spulen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",2);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",3);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein II");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","Oh, you want to help me some more? Well, I certainly need some thread for the robe. Bring me fifteen bobbins of thread, please.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",2);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",3);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress II");
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Oh, du willst mir noch mehr helfen? Nun, ich werde sicherlich einiges an Garn für die Robe brauchen. Bring mir doch bitte fünfzehn Spulen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",2);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",3);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein II");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Oh, you want to help me some more? Well, I certainly need some thread for the robe. Bring me fifteen bobbins of thread, please.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Oh, du willst mir noch mehr helfen? Nun, ich werde sicherlich einiges an Garn für die Robe brauchen. Bring mir doch bitte fünfzehn Spulen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","Oh, you want to help me some more? Well, I certainly need some thread for the robe. Bring me fifteen bobbins of thread, please.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Oh, du willst mir noch mehr helfen? Nun, ich werde sicherlich einiges an Garn für die Robe brauchen. Bring mir doch bitte fünfzehn Spulen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Ah, vielen lieben Dank. Ich weiß das zu schätzen und hoffe, du aktzeptierst dieses Kleid als Zeichen meines Anerkennung.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all",">",14);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",50,15);
    npcs.base.autonpcfunctions.AddConsequence("item",385,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst ein blaues Kleid und deine Schneidereifähigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",10);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",4);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Ah, thank you so much! I appreciate this greatly, I hope you accept this dress as compensation.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all",">",14);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",50,15);
    npcs.base.autonpcfunctions.AddConsequence("item",385,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a blue dress and your tailoring skill increases. You advance in Archmage Elvaine Morgan's favour.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",10);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",4);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Ah, vielen lieben Dank. Ich weiß das zu schätzen und hoffe, du aktzeptierst dieses Kleid als Zeichen meines Anerkennung.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all",">",14);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",50,15);
    npcs.base.autonpcfunctions.AddConsequence("item",385,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst ein blaues Kleid und deine Schneidereifähigkeit steigt.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",4);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Ah, thank you so much! I appreciate this greatly, I hope you accept this dress as compensation.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all",">",14);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",50,15);
    npcs.base.autonpcfunctions.AddConsequence("item",385,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a blue dress and your tailoring skill increases.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",4);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Garn, Garn, ohje, mir ist das Garn ausgegangen und du hast auch nicht genug!");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all","<",14);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Thread, thread, my dear, I lack thread and you don't have enough!");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",3);
    npcs.base.autonpcfunctions.AddCondition("item",50,"all","<",14);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    -- 3rd quest: Gather 5 red cloth.
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","I'm short on red cloth! But I need some for the robe for Elvaine Morgan. Can you please get me five panels?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",4);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",5);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress III");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Mir ist der rote Stoff ausgegangen! Den brauch ich aber für die Robe für Elvaine Morgan. Bringst du mir fünf Bahnen, bitte?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",4);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",5);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein III");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","I'm short on red cloth! But I need some for the robe for Elvaine Morgan. Can you please get me five panels?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",4);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",5);
    npcs.base.autonpcfunctions.AddConsequence("inform","[New quest] The Lazy Tailoress III");
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Mir ist der rote Stoff ausgegangen! Den brauch ich aber für die Robe für Elvaine Morgan. Bringst du mir fünf Bahnen, bitte");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",4);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",5);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Neues Quest] Das faule Schneiderlein III");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","I'm short on red cloth! But I need some for the robe for Elvaine Morgan. Can you please get me five panels?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Mir ist der rote Stoff ausgegangen! Den brauch ich aber für die Robe für Elvaine Morgan. Bringst du mir fünf Bahnen, bitte.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","I'm short on red cloth! But I need some for the robe for Elvaine Morgan. Can you please get me five panels?");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Mir ist der rote Stoff ausgegangen! Den brauch ich aber für die Robe für Elvaine Morgan. Bringst du mir fünf Bahnen, bitte.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Danke, genau, was ich gebraucht habe! Nun kann ich die Robe für den Erzmagier Morgan fertigstellen. Hier, dies war mein letzter Versuch, er hat sie zurückgeschickt, sie war ihm zu eng.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all",">",4);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",174,5);
    npcs.base.autonpcfunctions.AddConsequence("item",558,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst eine Meistermagierrobe und deine Schneidereifähigkeit steigt. Dein Ansehen bei Erzmagier Elvaine Morgan steigt.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",20);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",6);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Thank you, that is exactly what I needed! Now I can finish the robe for archmage Morgan. Here, take my last attempt, he sent it back, it was too tight for him.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all",">",4);
    npcs.base.autonpcfunctions.AddCondition("town","=","runewick");
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",174,5);
    npcs.base.autonpcfunctions.AddConsequence("item",558,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a master mage robe and your tailoring skill increases. You advance in Archmage Elvaine Morgan's favour.");
    npcs.base.autonpcfunctions.AddConsequence("rankpoints","runewick","+",20);
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",6);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Danke, genau, was ich gebraucht habe! Nun kann ich die Robe für den Erzmagier Morgan fertigstellen. Hier, dies war mein letzter Versuch, er hat sie zurückgeschickt, sie war ihm zu eng.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all",">",4);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",174,5);
    npcs.base.autonpcfunctions.AddConsequence("item",558,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest gelöst] Du erhältst eine Meistermagierrobe und deine Schneidereifähigkeit steigt.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",6);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Thank you, that is exactly what I needed! Now I can finish the robe for archmage Morgan. Here, take my last attempt, he sent it back, it was too tight for him.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all",">",4);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddConsequence("deleteitem",174,5);
    npcs.base.autonpcfunctions.AddConsequence("item",558,1,999,0);
    npcs.base.autonpcfunctions.AddConsequence("inform","[Quest solved] You are awarded a master mage robe and your tailoring skill increases.");
    npcs.base.autonpcfunctions.AddConsequence("skill","crafting","tailoring","+",1);
    npcs.base.autonpcfunctions.AddConsequence("qpg","=",6);
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Uhm... ich brauche mehr roten Stoff. Anderenfalls kann ich die Robe für den Erzmagier Morgan nicht fertigstellen.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all","<",4);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger(".+","Hrm... I need a little more red cloth. Otherwise, I cannot finish the robe for Archmage Morgan.");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",5);
    npcs.base.autonpcfunctions.AddCondition("item",174,"all","<",4);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    -- Final dialogue: No more quests, just nice hints
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","I don't need anything else, but thank you! You saved my day!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",6);
    npcs.base.autonpcfunctions.AddCondition("lang","english");
    npcs.base.autonpcfunctions.AddTraderTrigger("quest","Ich brauche nichts weiter, aber danke nochmal! Du hast mir ganz schön aus der Patsche geholfen.");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("mission");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",6);
    npcs.base.autonpcfunctions.AddCondition("lang","german");
    npcs.base.autonpcfunctions.AddTraderTrigger("task","I don't need anything else, but thank you! You saved my day!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("adventure");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",6);
    npcs.base.autonpcfunctions.AddTraderTrigger("Auftrag","Ich brauche nichts weiter, aber danke nochmal! Du hast mir ganz schön aus der Patsche geholfen!");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Aufgabe");
    npcs.base.autonpcfunctions.AddAdditionalTrigger("Abenteuer");
    npcs.base.autonpcfunctions.AddCondition("qpg","=",6);
    -- Cycletext: Please add at least(!) five cycletext messages. The more, the better. You can use emotes (#me is green), too.
    npcs.base.autonpcfunctions.AddCycleText("#me summt ein Liedchen.","#me hums a small song.");
    npcs.base.autonpcfunctions.AddCycleText("#me schaut zum Himmel und murmelt: 'Fast schon Zeit für ein Stück Kuchen.'","#me looks at the sky, and mumbles: 'Nearly time for pie...'");
    npcs.base.autonpcfunctions.AddCycleText("#me streichelt ein Schaf.","#me pats a sheep.");
    npcs.base.autonpcfunctions.AddCycleText("Oh, ist schon wieder Essenszeit?","Oh, is it nearly time to eat again?");
    npcs.base.autonpcfunctions.AddCycleText("Hallo da drüben!","Hello over there!");
    npcs.base.autonpcfunctions.AddCycleText("#me kichert freudig.","#me giggles.");
    npcs.base.autonpcfunctions.AddCycleText("Ohje, ich muss fertig werden.","Oh, I have to get things done.");
    -- ********* END DYNAMIC PART ********
    TradSpeakLang={0,1};
    TradStdLang=0;

    npcs.base.autonpcfunctions.increaseLangSkill(TradSpeakLang);
    thisNPC.activeLanguage=TradStdLang;

end

function nextCycle()  -- ~10 times per second
    initializeNpc();
    npcs.base.autonpcfunctions.SpeakerCycle();
end

function receiveText(texttype, message, originator)
    if npcs.base.autonpcfunctions.BasicNPCChecks(originator,2) then
        if npcs.base.autonpcfunctions.LangOK(originator,TradSpeakLang) then
            npcs.base.autonpcfunctions.TellSmallTalk(message,originator);
        else
            npcs.base.autonpcfunctions.Confused(
               "#me sieht dich leicht verwirrt an",
               "#me looks at you a little confused"
            );
        end
    end
end